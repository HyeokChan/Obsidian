# AWS SAA

### Getting started with AWS
1. AWS Regions
- 데이터 센터의 집합
2. AWS 리전 선택 방법
- 법률 준수 
- 지연 시간 : 대부분의 사용자가 미국에 있다면 미국 리전을 선택하는 것이 지연시간 감소
- 사용하고자 하는 서비스가 있는 리전 선택
- 요금 : 리전별로 요금 상이
3. 가용영역 (aws avaliability zones)
- 한 리전에 여러 가용영역 존재
- 가용영역은 하나 또는 두 개의 개별적인 데이터센터로 구성
- 데이터센터 < 가용영역 < 리전
4. 엣지 로케이션
- 40여 국가의 90개 이상의 도시에 400개가 넘는 전송 지점 존재
- 엣지 로케이션을 통해 최소 지연 시간으로 컨텐츠 전달 가능


### IAM
1. IAM User & Groups
- root 계정은 계정을 생성할 때만 사용
- 그 이후는 사용자를 생성해서 사용
- 여러 사용자를 하나의 그룹으로 관리
- 그룹 내에는 사용자만 설정 가능 (그룹안에 그룹 관리 불가)
- 한 사용자가 여러 그룹에 속하는 것은 가능
2. IAM Permissions
- 생성한 사용자에게 권한 부여 가능
3. IAM Policies inheritance
- IAM 그룹 별로 정책 적용 가능
- 그룹에 속하지 않은 사용자는 인라인정책으로 적용 가능
- 한 명이 여러 그룹에 속한 경우 각 그룹의 정책이 모두 적용됨
- 커스텀하여 신규 정책 생성 가능
4. IAM Policies Structure
```JSON
{
	"Version":"2012-10-17",
	"Id":"S3-Account-Permissions",
	"Statement":[
		{
			"Sid":"1",
			"Effect":"Allow",
			"Principal": {
				"AWS":["arn:aws:iam::123456789012:root"]
			},
			"Action":[
				"s3:GetObject",
				"s3:PutObject"
			],
			"Resource": ["arn:aws:s3:::mybucket/*"]
		}
	]
}
```

- Version: 정책 언어 버전
- Id: 정책 식별자(선택 사항)
- Statement: 하나 이상의 개별 명세서(필수)
- Sid: 명령문의 식별자(선택 사항)
- Effect: 액세스를 허용하거나 거부하는지 여부(Allow, Deny)
- Principal: 이 정책이 적용된 계정/사용자/역할
- Action: 이 정책이 허용하거나 거부하는 작업 목록
- Resource: 작업이 적용되는 리소스 목록
5. IAM Password Policy - MFA (Multi Factor Authentication)
- 비밀번호와 보안장치를 함께 사용하는 방식
- 자신의 비밀번호와 MFA 생성 토큰 사용
6. MFA Devices options in AWS
- 가상 MFA 장치 (google authenticator, authy ...)
- U2F 보안키
- 하드웨어 키 팝 MFA 장치
7. IAM Roles for Services
- AWS 서비스에 권한을 부여하기 위해 사용 (AWS 서비스 별 권한 적용)
- 예를 들어 AWS EC2 인스턴스에서 AWS의 어떤 정보에 접근할 때 사용하는 권한
8. IAM Security Tools (보안도구)
- IAM 자격 증명 보고서
- IAM 액세스 관리

### AWS 접근 방법
1. AWS Management console
2. AWS 명령줄 인터페이스 (CLI)
- 리소스를 관리하는 스크립트를 통해 작업 자동화 가능
- 액세스키를 통해 접근 (액세스키, 비밀액세스키)
3. AWS 소프트웨어 개발 키트 (SDK)
- 코딩을 통해 애플리케이션 내에 심어 두어서 사용
- 다양한 프로그래밍 언어 지원(JavaScript Python, PHP, .NET, Ruby, Java, Go Node.js, C++)
4. AWS CloudShell
- CLI 대체하여 사용
- 저장소 사용 가능

### IAM 모범 사례 및 요약
1. 모범 사례
- AWS 계정 설정 외에는 루트 계정을 사용 금지
- 물리적 사용자 1명 = AWS 사용자 1명
- 사용자를 그룹에 할당하고 그룹에 권한을 할당
- 강력한 비밀번호 정책 생성
- 다단계 인증(MFA) 사용 및 시행
- AWS 서비스에 권한을 부여하기 위한 역할 생성 및 사용
- 프로그래밍 방식 액세스를 위한 액세스 키 사용(CLI/SDK)
- IAM 자격 증명 보고서 및 IAM 액세스 어드바이저을 사용하여 계정 권한을 감사
- IAM 사용자 및 액세스 키 공유 금지
2. 요약
- 사용자: 물리적 사용자에 매핑되며 AWS 콘솔에 대한 비밀번호가 존재
- 그룹: 사용자만 포함
- 정책: 사용자 또는 그룹의 권한을 설명하는 JSON 문서
- 역할: EC2 인스턴스 또는 AWS 서비스용
- 보안: MFA + 비밀번호 정책
- AWS CLI: 명령줄을 사용하여 AWS 서비스를 관리
- AWS SDK: 프로그래밍 언어를 사용하여 AWS 서비스를 관리
- 액세스 키: CLI 또는 SDK를 사용하여 AWS에 액세스
- 감사: IAM 자격 증명 보고서 및 IAM 액세스 관리자

---
### EC2 기초
1. EC2
- aws 에서 제공하는 서비스형 인프라 스트럭쳐
- 가상 서버
- 운영체제 (리눅스, 윈도우, 맥), CPU 개수, RAM, 스토리지(EBS, EFS), 네트워크, 방화벽 규칙 등 선택하여 사용 가능
-  사용자 사용자 데이터 스크립트를 사용하여 인스턴스를 부트스트래핑 가능
	(부팅 작업 자동화 및 부팅 시 특정 작업(업데이트, 소프트웨어 설치) 명령 가능)
- 다양한 성능 및 옵션으로 EC2 인스턴스 생성 가능 예시
![image](https://github.com/HyeokChan/Obsidian/assets/48059565/3181cd03-ec08-4d45-95fc-d57856159862)
2. EC2 인스턴스 생성 과정
- 인스턴스의 운영체계 선택
- 인스턴스 타입(CPU, 메모리) 선택
- 키 페어 생성 및 선택 (인스턴스에 접근하기 위해 SSH 유틸리티를 사용하는 경우 필요)
	- 키 페어 타입, 키 페어 형식 선택
- 네트워크 설정
- 보안 그룹 생성 및 선택
- 스토리지 구성
- 사용자 데이터 스크립트 설정 (EC2 인스턴스 생성 시 실행되는 스크립트)
- 인스턴스를 중지 후 다시 시작하면 사설 IP는 유지되지만 공용 IP는 변경
3. EC2 유형
- 범용 인스턴스
	- 웹서버, 코드 저장소와 같은 다약한 작업에 적합
	- 컴퓨팅, 메모리, 네트워킹 간의 균형 좋음
- 고성능  프로세서 인스턴스(컴퓨팅 최적화)
	- 일부 데이터의 일괄 처리
	- 미디어 트랜스 코딩 작업
	- 고성능 웹서버
	- 고성능 컴퓨닝 HPC 작업
	- 머신 러닝
	- 전용 게임 서버
- 메모리 최적화 인스턴스
	- 메모리에서 대규모 데이터 셋을 처리하는 유형의 작업에 좋음
	- 인메모리 데이터베이스가 되는 고성능의 데이터베이스에 사용
	- 일라스틱캐시 등 분산 웹스케일 캐시 저장소에 사용
	- 대규모 비정형 데이터의 실시간 처리를 실행하는 애플리케이션에서 사용
- 스토리지 최적화 인스턴스
	- 로컬 스토리지에서 대규모의 데이터셋에 액세스할 때 적합
	- OLTP 시스템에 사용
	- NoSQL Database 사용
	- 메모리 데이터베이스의 캐시, 데이터 웨어하우징 애플리케이션, 분산 파일 시스템에 사용
4. 보안그룹
- EC2에 접근하는 트래픽 제어
- 방화벽 생성
- EC2 인바운드, 아웃바운드 규칙 생성 및 설정
![image](https://github.com/HyeokChan/Obsidian/assets/48059565/c9025205-2fd6-434d-a2b7-b0fe9fc03d07)
- 보안그룹은 여러 인스턴스에 연결할 수 있음
- 보안그룹은 지역과 VPC 결합으로 통제되어 있기 때문에 지역을 전환하면 새 보안그룹을 생성해야함
- 서버 접속 시 타임아웃이 발생하면 보안그룹 확인 필요
5. EC2 IAM 역할
- EC2 SSH 접속 후 aws configure 명령어를 통해 자격증명 및 액세스 ID, 비밀 액세스 키 등 지정 하면 이 계정 상의 누구라도 EC2 인스턴스 커넥트 등을 통해 자격 증명 정보 회수 가능
- 대신 IAM 역할(ROLES)을 통해 자격 증명 설정 필요 (서비스 별 권한 적용을 하는 IAM)
6. EC2 구매 옵션
- 온디맨드 인스턴스
	- 사용한 만큼 비용 지불
	- 비용이 가장 많이 들지만 바로 지불할 금액 및 장기적인 약정 없음
	- 단기적이고 중단 없는 워크로드가 필요할 때, 애플리케이션의 거동을 예측할 수 없을 때 사용
- 예약 인스턴스
	- 온디맨드에 비해 약 72% 할인 제공
	- 특정한 인스턴스 속성(타입, 리전, 테넌시, OS) 예약
	- 1년 혹은 3년 등 예약 기간 지정 후 추가할인
	- 전부선결제, 부분선결제, 선결제없음 옵션 존재 (할인 상이)
	- 사용량이 일정한 애플리케이션에 적합
	- 전환형 예약인스턴스 : 인스턴스 속성 변경 가능하지만 할인율 감
- 절약 플랜
	- 장기간 사용 시 할인
	- 사용량이 한도를 넘어가면 온디맨드 인스턴스로 전환
- 스팟 인스턴스
	- 할인폭이 가장 큼. 온디맨드에 비해 최대 90% 할인
	- 스폿 인스턴스에 대해 지불하려는 최대가격을 정의하고 스폿가격이 그 가격을 넘게됐을 때 인스턴스 손실 발생할 수 있음(경매식). 신뢰성 낮음
	- 따라서 인스턴스 고장에 대한 회복력이 있을 때 적합
	- 배치 작업이나 데이터 분석, 이미지 처리, 분산형 워크로드, 시작 시간과 종료 시간이 유연한 워크로드에 적합
	- 아주 중요한 작업이나 데이터베이스에는 부적합
	- 스팟블록
	- 일회성 요청, 영구 인스턴스 요청 : 영구 인스턴스 요청은 인스턴스가 중단 되는 경우 스팟 요청이 다시 실행, 유효성 확인 시 스팟 인스턴스 재시작
	- 스팟 인스턴스 요청을 중지한다고 해서 스팟 인스턴스가 종료되는 것음 아님. 재 요청을 중단하는 것. 스팟 인스턴스는 EC2 메뉴에서 직접 중단 필요 
	- 스팟 플릿
		- 선택적 온디맨드 인스턴스
		- 스팟 인스턴스 세트를 정의하는 방법
		- 설정한 가격제한에 맞게 가능한 LAUNCH POOL 선택
		- 스팟 플릿에 스팟 인스턴스를 할당하는 전략
			- 최저 가격 : 스팟 플릿은 가장 낮은 가격인 풀에서 인스턴스를 시작, 워크로드가 매우 짧은 경우 적합
			- 다양성 : 스팟 인스턴스는 정의한 모든 풀에 분산, 가용성이 좋아야하는 긴 워크로드에 적합.
			- 용량 최적화 : 먼저 사용가능한 용량이 가장 큰 풀 선택, 그 중 가격이 가장 낮은 풀 선택
			
	
- 전용 호스트
	- EC2 인스턴스 용량이 있는 실제 물리적 서버
	- 규정이나 법규를 반드시 준수해야 하는 회사 관련
- 전용 인스턴스
	- 전용 하드웨어에서 실행되는 인스턴스
- 전용 호스트 VS 전용 인스턴스 : 전용 인스턴스는 자신만의 인스턴스를 자신만의 하드웨어에 갖는다는 것에 비해 전용 호스트는 물리적 서버 자체에 대한 접근성을 갖고 낮은 수준의 하드웨어에 대한 가시성만 있음
- 용량 예약
	- 특정 AZ에 온디맨드 인스턴스 예약
	- 인스턴스 사용여부에 관계 없이 예약한 인스턴스에 대해 비용 지불 필요
	- 특정한 AZ에 있어야하는 단기적이고 중단 없는 워크로드에 적합
### EC2 - 솔루션 아키텍트 어소시에이트 레벨
1. EC2 IP
- 기본값으로 EC2 기기는 내부 AWS 네트워크엔 사설 IP 사용 (AWS 네트워크에서 사설 IP는 접근 불가능)
- WWW에는 공용 IP 사용
- 인스턴스에 고정된 공용 IP를 사용하기 위해서는 탄력적 IP 필요 (탄력적IP는 사용하지 않으면 비용 발생)
- 탄력적 IP 사용보다 ROUTE 53을 통해 공용 IP 사용 및 DNS 이름 할당 하는 방법 추천
- 또는 로드밸런서를 통해 공용 IP를 사용하지 않을 수 있음
2. EC2 배치 그룹 (위치)
- EC2 인스턴스가 AWS 인프라에 배치되는 방식을 제어하고자 할 때 사용
- 배치 그룹 전략
	- 클러스터 배치 그룹
		- 단일 가용 영역 내에 지연 시간이 짧은 하드웨어 설정을 사용
		- 동일한 가용영역 및 하드웨어에 존재, 하드웨어 문제에 위험 
	- 분산 배치 그룹
		- 인스턴스가 다른 하드웨어에 분산됨
		- 가용 영역 별로 분산된 배치 그룹당 7개의 EC2 인스턴스만 가질 수 있음 => 너무 큰 애플리케이션에서는 사용 제한이 있음
	- 분할(파티션) 배치 그룹
		- 분산 배치 그룹과 유사하나 하드웨어가 아닌 파티션에 의해 인스턴스 분할
		- 파티션 실패로 부터 안전함
		- 분산 배치 그룹에 비해 큰 애플리케이션에서 사용 가능함 
3. Elastic Network Interfaces (ENI)
- 탄력적 네트워크 인터페이스
- VPC의 논리적 구성 요소
- EC2 인스턴스가 네트워크에 액세스할 수 있도록 해줌
- EC2 인스턴스 생성 시 기본적으로 하나의 ENI와 연결됨
- ENI 추가 생성 및 EC2 인스턴스와 연결 가능 및 이동 가능 (같은 AZ에 있는 EC2 인스턴스와 연결 가능)
- 이를 통해 네트워크 장애 조치 가능 
4. EC2 절전모드 (Hibernate)
- RAM에 있던 인메모리 상태 보존
- 인스턴스 부팅 속도 개선
- 실행중인 EC2 존재. RAM 사용중 -> EC2 절전모드 시 RAM 내용을 EBS 볼륨으로 덤프 -> EC2 RAM은 삭제 -> EC2 인스턴스 다시 실행 시 EBS 볼륨에서 EC2 인스턴스 메모리로 RAM 내용 이동
- 사용하기 위해서 EBS 볼륨에 충분한 공간과 암호화 처리가 필요

### EC2 인스턴스 스토리지
1. EC2 인스턴스 스토리지 EBS 볼륨
- Elastic Block Store
- 인스턴스가 종료된 후에도 데이터 관리 가능
- 네트워크 드라이브 -> EC2 인스턴스에 분리되고 다른 인스턴스에 연결 가능(같은 가용영역)
- 스냅샷을 이용하여 다른 가용영역으로 볼륨 이동 가능
- CCP 레벨의 EBS볼륨은 한번에 두개 이상의 EC2 인스턴스에 연결될 수 없으며 하나의 EC2인스턴스에 여러개의 EBS 볼륨 연결은 가능
- EBS 볼륨 생성 후 EC2 인스턴스와 연결하지 않은 상태로 유지 가능
![image](https://github.com/HyeokChan/Obsidian/assets/48059565/8f6edd88-825e-4369-9149-89ff5c2ff61b)
- EC2 인스턴스를 통해 EBS 볼륨을 생성하는 경우 EC2 인스턴스 종료 시 EBS 볼륨도 삭제하도록 설정 가능
2. EBS 스냅샷
- EBS 볼륨의 특정 시점에 대한 백업
- 다른 가용 영역이나 다른 리전에 복사 가능(재해 복구 전략에 좋음)
![image](https://github.com/HyeokChan/Obsidian/assets/48059565/724489db-bc8e-486b-9ca9-07eb01322e85)
- 스냅샷을 스냅샷 아카이브로 이동 가능 (24~72시간 소요)
- EBS 휴지통 사용 가능 (1일~1년 보관)
- 빠른 스냅샷 복원(FSR)을 통한 EC2 인스턴스 초기화
3.  AMI (Amazon Machine Image)
- EC2 인스턴스를 통해 만든 이미지
- EC2 인스턴스에 설치하고자 하는 모든 소프트웨어를 AMI을 통해 패키징
- 기업에서 자체적으로 AMI를 구성하고 자신의 소프트웨어를 넣어서 판매하는 경우도 존재
- 다른 AZ로 EC2 인스턴스 복사할 때도 활용
4. EC2 인스턴스 스토어
- EC2 인스턴스에 연결된 물리적 서버 하드웨어 드라이브
- I/O 성능 향상을 위해 사용
- EC2 인스턴스를 중지하면 스토리지도 손실됨
- 따라서 버퍼, 캐시 등을 위해 사용
5. EBS 볼륨 유형
- gp2/gp3 : 범용 SSD 볼륨, 비용효과적
- io1/io2 : 최고성능 SSD 볼륨, 미션 크리티컬하고 지연시간이 낮고 대용량 워크로드에 사용
- st1 : 저비용의 HDD 볼륨
- 프로비저닝을 마친 IOPS
	- IOPS 성능을 유지할 필요가 있는 주요 애플리케이션
	- 16,000 IOPS 이상을 요하는 애플리케이션
	- 데이터베이스 워크로드
6. EBS 볼륨 다중 연결
- 하나의 EBS볼륨을 같은 가용영역에 있는 여러 EC2 인스턴스에 사용 가능
- 한번에 16개의 EC2 인스턴스만 같은 볼륨에 연결 가능
- 다중 연결 실행을 위해 클러스터 인식 파일 시스템 사용 필요 (XFS, EX4)
7. EBS 볼륨 암호화
- KMS 사용해서 암호화 가능
8. EFS
- 네트워크 파일 시스템
- EBS 보다 가용성과 확장성이 좋음
- 서로 다른 영역에 있는 EC2 인스턴스에 연결될 수 있음
- 콘텐츠 관리, 웹서빙, 데이터공유 등 사용사례
- 윈도우가 아닌 리눅스 기반 AMI와만 호환됨
- KMS 사용해서 암호화 가능
- 성능 모드 옵션
	- 범용 모드 : 지연시간에 민감한 사용 사례에 사용, 웹서버/CMS/Wordpress
	- I/O 모드 : 처리량 최대화, 지연시간이 더 길지만 처리량이 높고 병렬성이 높음, 빅데이터 매플리케이션/미디어 처리 시 유용 
- 처리량 옵션 
	- 버스팅 : MIB 더한 것, 파일시스템 크기와 비례한 용량
	- 프로비저닝 : 스토리지 크기에 관계 없이 처리량을 설정하고 싶은 경우 
	- 엘라스틱 : 워크로드에 따라 처리량을 자동 조절, 워크로드를 예측하기 어려울 때 유용
- 스토리지 클래스
	- 스토리지 계층 : 자주 액세스 되는 파일과 액세스 되지 않는 파일의 스토리지 계층을 이동
	- 다중 AZ로 EFS 설정 : 프로덕션 사용사례에 적합 (특정 AZ 다운 시 다른 AZ 사용)
	- 개발용 ONE ZONE EFS : 하나의 AZ에만 있어서 개발용으로 적합 
9. EBS VS EFS
- EBS 볼륨은 한 번에 하나의 인스턴스와 결합 (다중 결합 제외)
- EBS 볼륨은 하나의 AZ에 종속 (스냅샷을 통해 AZ 이동)
- EBS 볼륨 백언은 IO를 사용하므로 애플리케이션이 많은 트래픽을 처리하는 경우에는 부적합
- EFS 는 네트워크 파일 시스템으로 여러 AZ에 가용 가능
- EFS 가 EBS 보다 가격 높음

### 고가용성 및 스케일링 성 : ELB 및 ASG
1. ELB (일라스틱 로드 밸런서)
- 앞단에서 트래픽을 분산하여 여러 EC2 인스턴스에 전달
- 클래식 로드 밸런서 (CLB) -> 더 이상 지원하지 않아서 시험 X
- 애플리케이션 로드 밸런서 (ALB) : HTTP, HTTPS 애플리케이션 범용적
- 네트워크 로드 밸런서 : TCP, UDP, TLS, 고성능
- 게이트웨이 로드 밸런서 : 보안, 침입탐지, 방화벽 특화
- ELB에 보안규칙을 적용하여 EC2 에 대한 보안을 강화할 수 있음 (로드밸런서를 통해 들어오는 트래픽만 허용)
2. 애플리케이션 로드 밸런서
- 7계층, HTTP 전용 로드 밸런서
- URL 대상 경로에 기반한 라우팅 가능 (/user, /post ...)
- URL 호스트 이름, 쿼리문자열, 헤더에 기반한 라우팅 가능
- 포트 매핑 기능이 있어서 ECS 인스턴스의 동적 포트로 리다이렉션 가능 -> 마이크로서비스나 컨테이너 기반 애플리케이션에 가장 적합
- 하나의 ALB로 다수의 애플리케이션 처리 가능
3. 네트워크 로드 밸런서 : 고성능, TCP, UDP, 정적 IP
- L4 로드밸런서, TCP, UDP
- 고성능, 초당 수백만 건 처리, ALB에 비해 지연시간 짧음
- 가용영역 별로 하나의 고정 IP를 가짐 -> 여러개의 고정 IP를 가진 애플리케이션을 노출할 때 유용
- AWS 프리티어 X
- EC2 인스턴스를 대상그룹으로 두어 로드 밸런싱 할 수 있음
- ALB 앞에 NLB를 두도록 구성할 수 있음 -> NLB 덕분에 고정 IP를 얻을 수 있고 ALB로 HTTP 트래픽 분산도 가능
- 상태확인을 위해 TCP, HTTP, HTTPS 프로토콜 지원
4. 게이트웨이 로드 밸런서
- 방화벽, 침임탐지
- L3 계층
- GWLB의 2가지 기능
	- 투명 네트워크 로드 밸런서 : VPC의 모든 트래픽이 GWLB가 되는 단일 엔트리와 출구를 통과
	- 대상 그룹으로 트래픽을 분산하는 로드 밸런서
- 6081 포트의 GENEVE 프로토콜 사용 -> GWLB
5. ELB 고정 세션
- 사용자가 처음 접근했을 때 로드 밸런서를 통해 1번 인스턴스를 사용했다면 그 다음 요청도 1번 인스턴스로 보내는 것
- 쿠키를 통해 동작 (만료기간 존재)
	- 애플리케이션 기반 쿠키 (AWSALBAPP)
	- 기간 기반 쿠키 (AWSELB)
6. 교차 영역 밸런싱
- 트래픽을 여러 가용영역의 인스턴스로 같은 비율로 로드 밸런싱
- 애플리케이션 로드 밸런서는 기본적으로 교차영역밸런싱으로 동작함 (대상그룹의 속성에서 비활성화 가능)
- 네트워크 로드밸런서, 게이트웨이 로드밸런서는 기본적으로 비활성화 되어있음 (비용 지불 필요)
7. ELB SSL/TLS
8. SNI
- 여러개의 SSL인증서를 하나의 웹서버에 로드해서 하나의 웹서버가 여러개의 웹사이트를 지원할 수 있게 해줌
- ALB, NLB, CloudFront 에서 지원
9. Connection Draining (연결 드레이닝, 등록 취소 지연)
- 인스턴스가 등록 취소, 혹은 비정상인 상태에 있을 때 인스턴스에 어느 정도의 시간을 주어 활성 요청을 완료할 수 있게 하는 기능
- 등록취소 중인 인스턴스에 새로운 요청을 보내지 않음
10. Auto Scaling Group (ASG)
- 증가/감소한 로드에 맞춰 EC2 인스턴스를 자동으로 추가/제거
- CloudWatch(모니터링도구)와 통합되어 알림 발생 시 자동으로 스케일 인/아웃 가능
- ASG를 생성하면서 EC2 생성, ELB 설정 가능
11. ASG 스케일링 정책
- 단순히 cpu 사용률이나 특정 시간에 따라 미리 지정하는 스케일링 정책
- 예측 스케일링 정책
- Scaling Cooldowns : 스케일인/아웃 된 후 5분간은 해당 인스턴스의 안정화 시간이 필요함

### AWS RDS, Aurora, ElastiCache
1.  RDS
- 완전 자동화 서비스
- 지속적으로 백업 생성 및 복원 가능
- 읽기 전용 복제본 활용 가능
- 재해복구를 위해 다중 AZ 구성 가능
- 수직/수평 확장 가능
- RDS 인스턴스에 SSH 액세스는 불가능
- 오토스케일링 기능 활성화하면 스토리지 용량 증가 가능
2. RDS 읽기 전용 복제본
- 읽기 전용 복제본을 만들어서 성능 향상 가능 (읽기 성능 집중)
- 여러 가용영역이나 리전을 걸쳐서 생성 가능
- 비동기식 복제
- 완전 관리형 서비스이기 때문에 AZ간 이동해도 비용이 발생하지 않음 
- 하지만 리전 간 이동하는 경우 네트워크에 대한 복제 비용이 발생
3. RDS 다중 AZ
- 재해 복구에 사용
- 동기식 복제
- 가용성을 높힐 수 있음, 장애 대비
- 메인 디비에 문제가 발생하는 경우 자동으로 다중AZ로 복제된 디비가 메인 디비로 사용됨
- 재해 복구를 대바해서 읽기 전용 복제본을 다중 AZ로 설정할 수도 있음
- 싱글 AZ를 다중 AZ로 변경할 때 다운타임 없음
4. RDS 커스텀
- 오라클, ms sql에서만 사용 가능
- db os 접근 및 수정 가능, 관리 권한
5. Aurora
- 10GB 기본으로 시작하지만 128TB 까지 자동으로 증가
- RDS 보다 20퍼센트 정도 비싸지만 스케일링에 효과적
- 3개의 AZ에 총 6개의 사본을 만들어서 가용성이 높음
- 자가 복구 기능이 있음. 백엔드에서 P2P 복제를 통해
- 마스터에 문제가 생기면 다른 읽기 복제본이 마스터를 대체함
- 라이터 엔드포인트 : DNS 이름으로 항상 마스터를 가리킴
- 마스터 외에 다수의 읽기 복제본이 존재하며 15개까지 생성 가능
- 리더 엔드포인트 : 모든 읽기 전용 복제본과 자동으로 연결되어 로드밸런싱을 가능하게함
- 삭제 시 리더 엔드포인트, 라이터 엔드포인트 삭제 후 오로라 삭제
6. 오로라 고급 개념
- 오토스케일링 : 클라이언트 트래픽이 많은 경우 읽기 전용 복제본을 더 생성하고 리더 엔트포인트에 연결함
- 사용자 지정 엔드포인트 : 읽기 전용 복제본 간에 사이즈를 다른 경우 사이즈가 큰 복제본에 특정 엔드포인트로 설정하여 처리할 수 있음
- 서버리스 : 용량 계획을 세울 필요가 없어서 워크로드가 많지 않거나 간헐적이거나 예측할 수 없을 때 효율적
- 멀티마스터 : 라이터노드에 지속적인 쓰기 작업이 필요할 때 사용
- 글로벌 오로라 : 리전간에 읽기 전용 복제본이 있는 경우
- 글로벌 데이터베이스의 데이터를 리전 간 복제하는 데 평균 1초 미만이 소요되는 것 -> 오로라
- 오로라는 머신러닝 부분과도 통합되어 있음(사기탐지, 감성분, 광고 타겟팅, 제품 추천)
7. RDS 백업
- 자동 백업을 통해 5분전 데이터 백업 가능, 비활성화 가능
- 수동 데이터베이스 스냅샷을 통해 수동 백업, 자동 백업과 달리 원하는 기간 만큼 백업 가능
- 스냅샷 기능을 통해 데이터베이스 유지 비용 감소 가능
8. 오로라 백업
- 자동 백업 : 1일에서 35일까지 가능, 비활성화 불가
- 시점 복구 기능을 통해 특정 시점으로 복구 가능
- 스냅샷을 통한 백업
9. 오로라 데이터베이스 복제
- 백업 및 복원 작업 대신 복제도 가능, 더 빠름
10. RDS, 오로라 보안
- KMS 를 통해  암호화 실행됨
- 마스터가 암호화 되어야 읽기 전용 복제본도 암호화 가능
- 로그인/패스워드 말고 IAM을 통해서도 접근 가능
11. RDS 프록시
- 프록시를 사용하면 애플리케이션이 데이터베이스 내에서 데이터베이스 연결 풀을 형성하고 공유할 수 있음
- RDS 데이터베이스 인스턴스에 연결이 많은 경우 CPU와 RAM 등 데이터베이스 리소스의 부담을 줄여서 효율성을 향상시킬 수 있음
- RDS 프록시가 장애 조치가 발생한 RDS 데이터베이스 인스턴스를 처리하므로 장애 조치 시간이 개선됨
- 데이터베이스에 IAM 인증을 강제함
- RDS는 퍼블릭 액세스가 불가능하고 VPC를 통해서만 액세스 가능
- RDS 프록시를 사용해서 Lambda 함수의 연결 풀 생성 가능
12. ElastiCache
- 캐싱 기술인 Redis 또는 Memcached를 관리할 수 있도록 도와줌
- 애플리케이션을 상태 비저장형으로 할 수 있게 도와줌
- 사용 시 캐시를 쿼리하도록 애플리케이션 변경 필요
- Redis
	- 자동 장애 조치 기능이 있는 다중 AZ 존재
	- 읽기 복제본 있음
	- RDS와 유사
	- AOF 지속성을 이용한 데이터 내구성 있음, 백원 및 복원 기능
	- 데이터 내구성에 대한 것. 기능 면에서는 캐시로서, 세트 및 정렬된 세트 지원
- Memcached
	- 데이터 분할을 위해 멀티 노드를 사용함 -> 샤딩
	- 고가용성이 없고 복제가 일어나지 않음
	- 영구 캐시가 아니고 백업 및 복원 없음
	- 분산되어 있는 순수한 캐시
13. ElastiCache 보안
- Redis의 경우 IAM 사용, 나며지는 사용자이름과 비밀번호
- Redis AUTH
- SSL 전송 중 암호화 지원
- Memcached는 SASL 기반 승인 제공
14. ElastiCache 데이터 로드 패턴
- 지연로딩 -> 캐시 히트 체크 후 처리
- Write Through : 데이터베이스에 기록될 때마다 캐시에 데이터를 추가하거나 업데이트
- Redis 정렬된 세트 : 요소가 추가될 때마다 실시간으로 순위 매긴 후 올바른 순서로 추가

### Route 53
1. DNS
- Domain Name System
- url -> ip 변환
- 도메인 레지스트리 : 도메인 이름을 등록하는 곳(route 53, GoDaaddy .. )
2. Route 53
- 고가용성, 확장성을 갖춘 완전히 관리되며 권한이 있는 DNS
- 리소스 관련 상태 확인 가능
- SLA 가용성을 제공하는 유일한 AWS 서비스
- TTL : DNS 리존버에서 레코드가 캐싱 되는 시간 (타임 투 리브)
- 레코드 종류 
	- A : 호스트이름과 IPv4 IP 매핑
	- AAAA : 호스트이름과 IPv6 IP 매핑
	- CNAME : 호스트이름과 다른 호스트이름 매핑 
	- NS : 호스팅 존의 이름 서버, 트래픽이 도메인으로 라우팅되는 방식을 제어
3. 호스팅 존
- 레코드의 컨테이너
- 도메인과 서브도메인으로 가는 트래픽의 라우팅 방식 정의
- 퍼블릭 호스팅 존 : 공개되는 도메인 이름, 요청 쿼리에 응답 가능 
- 프라이빗 호스팅 존 : 공개되지 않는 도메인 이름 지원, VPC에서만 동작
4. TTL
- Time To Live
- TTL은 클라이언트에게 DNS 요청 결과를 캐시하도록 요청
- 클라이언트가 같은 url을 접속했을 때 DNS 시스템에게 쿼리를 보내지 않고 서버 접속 가능
5. CNAME vs Alias
- CNAME은 호스트 이름이 다른 호스트 이름으로 향하도록 할 수 있음. 하지만 루트 도메인 이름이 아닌 경우에만 가능
- Alias 별칭 레코드는 Route 53에 한정되지만 호스트 이름이 특정 AWS 리소스로 향하도록 할 수 있음
- 별칭 레코드는 루트 및 비루트 도메인 모두에 작동 가능
- 별칭 레코드 대상
	- ELB
	- CloudFront
	- API Gateway
	- 일라스틱 빈스톡
	- S3 웹사이트 (S3 버킷 아님)
	- VPC 인터페이스 엔드포인트
	- 글로벌 엑셀러레이터
	- 동일 호스트존의 Route 53
- EC2 DNS 이름은 별칭 레코드의 대상이 될 수 없음
6. 라우팅 정책
- DNS 관점의 라우팅 (로드밸런서 라우팅 아님)
- 단순 라우팅 정책
	- 일반적으로 트래픽을 단일 리소스로 보내는 방식
	- 단순 라우팅 정책에 별칭 레코드를 함께 사용하면 하나의 AWS 리소스만을 대상으로 지정할 수 있음
	- 상태 확인은 할 수 없음
- 가중치 기반 라우팅 정책
	- 가중치를 활용해서 요청의 일부 비율을 특정 리소스로 보냄
	- 해당 레코드로 트래픽을 얼마나 보낼 지 결정 가능
	- DNS 레코드들은 동일한 이름과 유형을 가져야 함
	- 서로 다른 지역들에 걸쳐 로드 밸런싱 해야하거나 적은 양의 트래픽을 보내 새 애플리케이션을 테스트 하는 경우 사용
- 지연 시간 기반 라우팅 정책
	- 지연시간이 가장 짧은, 가장 가까운 리소스로 리다이렉팅 하는 정책
	- 지연 시간에 민감한 웹사이트나 애플리케이션에 사용
- 라우팅 정책 지리적 위치
	- 지연 시간 기반의 정책과는 다르게 사용자의 실제 위치를 기반으로 함
	- 사용자의 위치와 설정한 정책 위치가 같지 않으면 기본 레코드를 사용함
- 지리적 근접 라우팅
	- 사용자와 리소스의 지리적 위치를 기반으로 트래픽을 리소스로 라우팅
	- 편향값을 사용해 특정 위치를 기반으로 더 많은 트래픽을 이동
	- 지리적 위치에 편향값으로 가중치를 설정하는 느낌
- IP 기반 라우팅 정책
	- 클라이언트 IP 주소를 기반으로 라우팅
	- CIDR에 따라 트래픽을 어느 애플리케이션으로 보낼 지 정함
- 다중 값 정책
	- 트래픽을 다중 리소스로 라우팅할 때 사용
	- 클라이언트 측면의 로드 밸런싱

7. Route 53 상태 확인
- 공용 리소스, 개인 리소스의 상태를 확인 하는 방법
- 사용 불가능한 상태의 인스턴스로 트래픽을 보내지 않기 위해 상태 체크
- 공용 엔드 포인트 모니터링
- 계산된 상태 확인 : 여러개의 상태 확인 결과를 하나로 합침
- CloudWatch 경보의 상태를 모니터링 : 개인 리소스 상태 확인 방법, 다른 방법은 VPC가 외부에 있어서 확인 못함
8. 라우팅 정책 장애 조치
- 상태 확인이 비정상이면 Route 53은 자동으로 2번째의 EC2 인스턴스로 연결해서 장애 조치

### 클래식 솔루션 아키텍처
1. WhatIsTheTime.com
- 공용 EC2 인스턴스 t2.micro
- 고정 IP 주소를 설정하기 위해 탄력적 IP주소 연결
- 앱에 대한 트래픽이 많아 지면서 m5.large 인스턴스로 수직적 확장
- 하지만 수직적 확장을 진행하는 동안에 다운타임 발생
- m5.large 인스턴스를 추가하여 수평적확장 진행 (추가된 인스턴스들도 모두 탄력적 IP와 연결되어 있음) -> 세개의 EC2 인스턴스와 세개의 탄력적 IP
- 사용자들이 이 앱에 접근하기 위해서는 각각의 탄력적 IP를 알고 있어야 하는 불편함이 있음
- -> 탄력적 IP를 제거하고 Route 53 활성화
- 인스턴스들을 상황에 따라 즉각적으로 추가하거나 제거하고 싶은데 제거하는 경우 Route 53 레코드에 설정한 TTL 만큼 사용자가 제거된 인스턴스로 접속할 수 있음
- -> 로드 밸런서 추가 필요
- 로드 밸런서에서도 상태 확인 기능이 있어서 제거된 인스턴스로는 트래픽을 보내지 않게 할 수 있음
- 로드 밸런서가 IP 주소를 지속적으로 바꾸기 때문에 Route 53 A 레코드를 사용할 수 없고 별칭 레코드를 사용해야함
- 오토 스케일링 그룹(ASG)를 사용해서 수동으로 인스턴스를 추가/제거 하지 않아도 됨
 - 지진이 발생해서 가용영억 1번이 다운되면 애플리케이션도 다운됨
 - -> 다중 AZ를 사용해서 가용성 높임
 - 애플리케이션의 비용을 줄이기 위해 1년 내내 사용할 인스턴스를 예약 인스턴스로 변경
2. MyClothes.com
- Route 53, 다중 AZ, ELB, ASG
- 장바구니를 생성하고 다음 요청 때 장바구니를 생성한 인스턴스가 아닌 다른 인스턴스로 가는 경우 장바구니가 사라지는 현상 발생할 수 있음
- -> ELB의 세션 밀접도(ELB Stickness)를 도입해 다음 요청 때 동일한 인스턴스로 가게 함
- 하지만 만약 EC2 인스턴스가 어떤 이유로 종료되면 장바구니 정보도 사라지게됨
- 사용자 쿠키를 사용해서 EC2 인스턴스가 장바구니 내용을 저장하는 대신 사용자쪽에서 장바구니 내용을 저장하도록 함
- -> 그러나 HTTP 요청이 점점 더 무거워지는 문젝 ㅏ있음
- 또한 쿠키가 공격자에 의해 변경될 수 있음
- -> EC2 인스턴스가 반드시 사용자 쿠키의 내용을 검증해야함
- 서버 세션 개념 도입해서 세션 ID만 보냄
- 백그라운드의 ElastiCache 클러스터가 장바구니 내용을 찾아서 세션 데이터를 불러올 수 있음
- 사용자 데이터를 데이터베이스에 저장하려고 함
- -> RDS 인스턴스와 통신하여 장기적인 저장 수행
- 사용자가 늘어서 읽기 트래픽이 증가함
- -> RDS 읽기 전용 복제본 생성하여 처리
- -> ElastiCache를 활용하여 읽기 성능 향상
- 재난에 대비하여 RDS도 다중 AZ 기능 적용
- 또다른 방법으로 인계 받을 수 있는 대기 복제본 사용
- -> Redis
3. MyWordPress.com
- 어떤 드라이브에 그림을 저장하고 기본적으로 모든 인스턴스들이 그 데이터에 접근해야함
- 사용자 데이터와 블로그 내용 등 모든게 MySQL 데이터베이스에 저장되어야 하고 글로벌하게 확장할 수 있어야 함
- -> RDS가 있는 계층 생성
- 더 크게 확장하고 싶은 경우 이 계층을 오로라 MySQL로 교체
- 다중 AZ, 읽기 전용 복제번, 글로벌 데이터베이스까지 적용 가능
- 이미지 저장
- -> EBS 볼륨에 저장하고 불러옴
- EBS 볼륨을 확장하는 경우 하나의 EBS볼륨에만 특정 이미지가 저장되고 나머지 볼륨에는 없음
- -> EFS를 사용
- 탄력적 네트워크 인터페이스를 위해 각각의 AZ에 ENI 생성
- -> 스토리지가 모든 인스턴스에게 공유됨
4. 애플리케이션을 더 빠르게 인스턴스화 하는 방법
- EC2 인스턴스에서 Golden AMI 사용
- EC2 생성 시 사용자데이터 사용
- -> 위 2개 혼합해서 사용
- RDS 데이터베이스는 스냅샷 복구를 통해 빠른 생성
- EBS 도 스냅샷을 통해 빠른 생성 및 복구
5. Elastic Beanstalk
- 여러 애플리케이션에 대해 AWS 서비스를 적용할 때 비슷한 설정을 하는 경우가 많은데 각각 매번 생성하고 설정하기 번거로움
- -> Elastic Beanstalk 사용
- 하나의 인터페이스에서 EC2, ASG, ELB, RDS 등 모든 컴포넌트를 재사용하는 개념

### Amazon S3
1. S3 사용 사례
- 백업, 스토리지로 사용 (파일, 디스크)
- 재해복구 용도
- 아카이브 용도
- 하이브리드 클라우드 스토리지 : 온프레미스에 스토리지가 있지만 S3를 통해서 확장 가능
- 애플리케이션, 영상 파일 및 이미지 등 호스팅
- 빅데이터 분석 수행
- 정적 웹사이트 호스팅
2. S3 버킷
- S3는 파일을 버킷에 저장함
- 버킷은 계정 안에 생성됨
- 버킷의 이름은 전체에서 고유해야함
- 버킷은 반드시 특정 AWS 리전에서 정의되어야 함
3. S3 객체
- S3 객체의 키는 파일의 전체 경로임
4. S3 보안 및 버킷 정책
- 사용자 기반 : IAM 정책 사용
- 리소스 기반
	- S3 버킷 정책 사용
	- 객체 ACL 액세스 제어 목록 사용
	- 버킷 ACL 액세스 제어 목록 사용
- 암호화키를 사용하여 객체 암호화
5. 버킷 정책
6. 정적 웹사이트 호스팅
- 버킷을 활성화하여 정적 웹사이트 호스팅 가능
7. S3 파일 버전 관리
- 사용자가 파일을 업로드 할 때 마다 선택키에서 해당 파일의 버전 생성
- 이전 버전 복구 및 롤백 가능
8. S3 복제
- CRR : 교체리전복제
	- 다른 리전에 S3 버킷을 복제해야할 때 사용
	- 두 버킷 모두 버전 관리 기능이 활성화 되어야 함
- SRR : 같은 리전으로 복제
	- 다수의 S3 버킷간의 로그를 통합할 때나, 개발환경이 별도로 있어서 운영환경과 개발환경 간의 실시간 복제를 필요로 할 때 사용함
- 복제 기능이 정상적으로 실행되려면 S3에 올바른 IAM 권한, 즉 읽기, 쓰기 권한을 S3에 부여해야 함
- 복제는 새로 추가한 객체만 복제하고 기존의 객체를 복제하려면 S3 배치 복제 기능을 사용해야함
-  체이닝 복제는 불가능함 1->2->3
- 오리진 버킷에서 파일을 삭제해도 복제된 버킷에서 파일이 사라지진 않음
9. S3 스토리지 클래스
- 모든 스토르지 클래스의 내구성은 동일함 99.9999999%
- Amazon S3 Standard
	- 자주 액세스 하는 데이터에 사용
	- 지연시간이 짧고 처리량이 높음
	- 두개의 기능 장애를 버틸 수 있음
	- 빅데이터분석, 모바일/게임 애플리케이션, 콘텐츠 배포에 사용
	- 가용성 99.99%
- Amazon S3 Infrequent Access
	- 자주 액세스하지 않지만 필요한 경우 빠르게 액세스해야하는 데이터에 사용
	- Standard보다 비용 효율적이지만 검색 비용이 발생
	- 가용성 99.9%
- Amazon S3 One Zone - Infrequent Access
	- 단일 AZ 내에서는 높은 내구성을 갖미나 AZ가 파괴된 경우 데이터를 잃게 됨
	- 가용성 99.5%
	- 온프레미스 데이터를 2차 백업하거나 재생성 가능한 데이터를 저장할 때 사용
- Glacier 스토리지 클래스
	- 콜드 스토리지
	- 아카이빙과 백업을 위한 저비용 객체 스토리지
	- 스토리지 비용과 검색 비용 발생
	- Glacier Instant Retrieval
		- 밀리초 단위 검색 가능
		- 분기에 한번 액세스 하는 데이터에 적합
		- 최소 보관 기간 90일
	- Glacier Flexible Retireval
		- Expedited : 데이터를 1~5분 이내에 받음
		- Standard : 데이터를 3~5시간 내에 받음
		- Bulk : 무료이지만 데이터를 5~12시간 내에 받음
		- 최소 보관 기간 90일
	- Glacier Deep Archive
		- 장기보관을 위한 클래스
		- Standard : 12시간
		- Bulk : 48시간
		- 오래걸리지만 비용이 가장 저렴하고 최소보관기간도 180일
- Amazon S3 Inteligent Tiering
	- 사용 패턴에 따라 액세스된 티어 간에 객체 이동 가능
	- 소액의 월별 모니터링 비용과 티어링 비용 발생하지만 검색 비용은 없음
- 시간 변화에 따라 클래스 변경 자동화 가능
### 고급 Amazon S3
1. S3 수명 주기 규칙
- 라이프사이클 규칙을 이용해서 자동으로 스토리지 클래스를 이전할 수 있음
- 객체를 60일 후에 Standard 클래스로, 6개월 뒤에 Glacier로 이전 가능
- Expiration actions도 설정해서 일정한 시간 뒤에 객체를 삭제하도록 설정도 가능
- 특정한 접두어에 대한 지정 가능
- Amazon S3 Analytics를 이용해서 객체를 다른 클래스로 이전할 최적의 일 수 계산 및 결정 가능
	- Standard, Standard-IA에 대한 추천사항 제시
	- One-Zone, Glacier와는 호환 안됨
2. S3 요청자 지불
- 버킷의 소유자는 버킷의 객체 스트리지 비용 부담
- 요청자가 객체를 다운로드 하면 요청자가 다운로드와 관련된 네트워킹 비용 지불
- 대량의 데이터 셋을 다른 계정과 공유하려고 할 때 유용
- 요청자는 익명이여서는 안되며 AWS에서 인증을 받아야함
3. S3 이벤트 알림
- 객체가 생성되거나 삭제되거나 복구, 복제 되는 등 이벤트가 있을 때 알림 설정 가능
- 이벤트에 대한 필터링 가능
- 이벤트 알림이 작동하려면 IAM 권한을 가지고 있어야함
- SNS, SQS, 람다 함수가 이벤트 알림 타깃임
- 모든 이벤트는 S3 버킷을 통해서 Amazon EventBridfe로 이동
- Amazon EventBridge를 이용해서 고급 필터링 옵션 사용 가능
4. S3 퍼포먼스
- S3는 기본적으로 요청이 아주 많을 때 자동으로 확장됨
- bucket/folder1/sub1/file의 접두사는 bucket, file 사이에 있는 folder/sub1임
- S3 성능과 최적화 방법
	- 100MB가 넘는 파일은 멀티파트 업로드를 사용하는 것이 좋음
	- 5GB가 넘는 파일은 반드시 사용해야함
	- 멀티파트 업로드는 업로드를 병렬화 함
	- S3에서 모든 파트가 업로드 되면 자동으로 모든 파트들을 다시 합침
	- 업로드, 다운로드 전송 가속화를 위해 엣지 로케이션 사용
	- 파일을 수신하고 파일을 읽는 가장 효율적인 방법은 S3 바이트 범위 가져오기 기능 사용
	- 파일에서 특정 바이트 범위를 가져와서 GET 요청을 병렬화함
	- 파일 다운로드 속도를 높이기 위해 사용
	- 또 다른 방법으로는 파일의 일부만 검색
5. S3 셀렉트 & Glacier Select
- S3에서 파일을 검색할 때 검색 후 필터링하면 너무 많은 데이터를 검색하게 됨
- 대신 서버층 필터링을 통해서 해결
- SQL 문을 통해 간단히 행과 열을 사용해서 필터링 가능
- S3 Select를 사용하면 S3가 대신 파일을 필터링 해주고 필요한 데이터만 검새 가능
- 속도는 400% 빨라지고 비용은 80% 감소함
6. S3 Batch Operations
- 단일 요청으로 기존 S3 객체에서 대량 작업을 수행하는 서비스
- 한번에 많은 S3 객체의 메타데이터와 프로퍼티 수정 가능
- 버킷의 기존 객체 복제 가능
- S3 버킷 내 암호화 되지 않은 모든 객체를 암호화할 수 도 있음
- ACL이나 태그를 수정하거나 S3 Glacier에서 한번에 많은 객체 복원 가능
- 람다 함수를 호출해서 S3 Batch Operations의 모든 객체에서 사용자 지정 작업 수행 가능
- S3 Batch Operations를 사용하면 재시도 관리 가능, 진행 상황 추적 및 작업 완료 알림 발송 가능
- S3 Inventory -> S3 Select -> S3 Batch Operations

### 아마존 S3 보안
1. S3 암호화
- SSE-S3 암호화
	- AWS 가 처리하고 관리하고 소유한 키를 이용해서 암호화
	- 고객은 키에 액세스 불가능
- SSE-KMS
	- KMS 서비스를 이용해서 직접 자신의 키를 관리
	- CloudTrail을 이용해서 로깅 가능
	- 암호화 키 순환 정책에 대한 제어권은 이용자에게 있음
- SSE-C
	- HTTPS를 이용해서 키를 AWS S3에 전송
	- 암호화 키에 대한 모든 제어권은 이용자에게 있음
- 클라이언트 측 암호화
	- 클라이언트가 직접 데이터를 암호화한 후에 S3에 전송한다는 개념
2. 전송 중 암호화
- SSL/TLS
- 버킷 정책을사용해서 전송 중 암호화 강제 가능
3. S3 기본 암호화
- 기본 암호화는 SSE-S3 암호화
- 버킷 정책으로도 버킷 안의 암호화를 강제할 수 있음
- 버킷 정책이 SSE-S3 암호화보다 선제적으로 적용됨
4. S3 CORS
- 클라이언트가 S3 버킷에서 교차 오리진 요청을 하면 정확한 CORS 헤더를 활성화 해야함
- 특정 오리진을 허용하거나 * 를 붙여서 모든 오리진을 허용
5. S3 MFA Delete 보안 기능
- 멀티팩터 인증
- 사용자가 장치에서 코드를 생성하도록 강제
- Google Authenticator 애플리케이션 등 MFA 장체 사용
- 객체 버전을 영구적으로 삭제할 때, 버킷에서 버저닝을 중단할 때 MFA 인증이 필요함
- 버킷 소유자, 즉 루트 계정만이 MFA Delete 를 활성화 하거나 비활성화 할 수 있음
6. S3 액세스 로그
- 감사 목적으로 S3 버킷에 대한 모든 액세스를 기록할 수 있음
- S3로 보낸 모든 요청은 승인 또는 거부 여부에 상관없이 다른 S3 버킷에 기록됨
- Amazon Athena 같은 데이터 분석 도구로 해당 데이터 분석 가능
- 대상 로깅 버킷은 같은 AWS 리전에 있어야함
- 로깅 버킷과 모니터링 대상 버킷이 같으면 무한 로깅 문제가 발생할 수 있음
7. S3 사전 서명된 URL
- AWS 외부의 사용자에게 한 파일에 대한 액세스 권한을 부여해야 할 때 해당 파일을 퍼블릭으로 설정하지 않고 미리 서명된 URL을 생성해서 사용자에게 부여
- 미리 서명된 URL의 만료기간 후에는 S3 버킷에서 파일을 다시 가져옴
8. S3 잠금 정책 및 Glacier 볼트 잠금
- WORM 모델을 채용하기 위해 Glacier 볼트를 잠금
- WORM : 한 번 쓰고 여러 번 읽는다
- 객체를 가져와서 S3 Glacier 볼트에 넣은 다음 수정하거나 삭제할 수 없도록 잠그는 것
- S3 객체 잠금을 사용하면 특정 객체 버전이 특정 시간동안 삭제되는 걸 차단할 수 있음
- 규정준수모드, 거버넌스 보존 모드 있음
- 규정준수모드는 절대 수정할 수 없고 거버넌스 보존 모드는 관리자 같은 일부 사용자는 IAM을 통해 수정/삭제할 수 있음
- S3 객체 잠금으로 법적 보존 상태 설정 가능
- 법적 보존 상태를 사용하면 버킷 내 모든 객체를 무기한으로 보호
9. S3 액세스 포인트
- 버킷에 사용자와 데이터가 많아질수록 관리하기가 어려워짐
- S3 액세스 포인트를 만들어서 해결 가능
- 특정 액세스 포인트를 특정 데이터에 연결되도록 사용 가능
- /finace -> 재무 데이터, /sales -> 영업 데이터
- 액세스 포인트 별로 권한 적용 가능
10. S3 오브젝트 람다
- 호출자 애플리케이션이 객체를 받기 직전에 그 객체를 수정하려는 경우
- 람다 함수를 사용해서 객체를 받는 중에 객체를 수정해서 사용 가능
- 객체에 필터링이 필요한 경우 새로운 객체 버전을 만들지 않고 람다함수를 통해 필터링을 하고 객체를 받을 수 있음
- 워터마크 생성 등에도 활용

### 네트워킹 및 컨텐츠 전송
1. CloudFront
- CDN 서비스, 컨텐츠 전송 네트워크
- 서로 다른 엣지 로케이션에 미리 캐싱하여 읽기 성능 높임
- 컨텐츠가 분산되어 있어서 DDos 공격에서 보호 받을 수 있음
2. CloudFront 구성
- 오리진(S3, ELB, API Gateway) -> CloudFront -> 엣지로케이션 -> 
3. CloudFront 특징
- 사용자에게 가까운 곳의 엣지로케이션에서 데이터 전송
- 글로벌 배포
- 전세계 사용자에게 최상의 경험 제공
- 콘텐츠 지연시간 최소화
- 비디오 콘텐츠 등의 실시간 스트리밍 배포
- 오리진에서 CloudFront로 전송되는 비용은 부과하지 않음
4. Price Classes
- 비용 절약을 위해 가격등급에 따라 배포하는 엣지 로케이션 수를 줄일 수 있음
5. Origin Group
- 여러개의 오리진을 그룹화해서 하나의 CloudFront를 통해 접근
- 기본 오리진과 보조 오리진으로 구성해서 고가용성 향상
6. Origin Shield
- CloudFront에 캐싱 계층을 하나 더 두워서 오리진의 로드를 최소화하고 가용성을 높임
7. Lambda Edge
- 엣지 로케이션에서 Node.js 또는 Python 코드를 실행할 수 있는 서버리스 엣지 컴퓨팅 기능
- 최종 사용자과 오리진의 요청/응답 이벤트에 대한 코드 실행
- 밀리초 단위 실행 함수
8. CloudFront Fuction
- 엣지 로케이션에서 JS 코드를 실행할 수 있는 서버리스 엣지 컴퓨팅 기능
- 최종 사용자의 요청/응답 이벤트에 대한 코드만 실행
- 서브 밀리초 단위 경량 함수
9. CloudFront 보안
- 클라이언트 프로토콜 정책 적용 가능
- 오리진 프로토콜 정책 저굥ㅇ 가능
10. OAI(Origin Access Identity)
- S3 버킷의 액세스를 클라우드 프론트를 통해서만 할 수 있도록 하는 기능
11. Signed URL, Signed Cookies
12. 지역 제한
13. AWS WAF, AWS Shield와 결합해 DDoS 방어 기능 가능
14. 필드 레벨 암호화

15. 글로벌 엑셀러레이터
- 가장 가까운 위치로 트래픽을 라우팅하여 인터넷 대기시간을 줄이고 전송 성능을 향상하는 서비스
- 미사용 시 서버로 부터 지리적으로 먼 사용자는 많은 인터넷 라우팅을 하여 속도가 느림
- 사용 시 엣지 로케이션을 통해 전용 네트워크를 사용함
16. 글로벌 엑셀러레이터 특징
- 두개의 Anycast 퍼블릭 고정 IP가 생성됨
- Anycast : 네트워크 트래픽을 가장 가까운 노드로 전송하는 라우팅 방식
- Health Check를 통해 하나의 서버가 문제가 생긴 경우 다른 정상적인 서버 사용

17. CloudFront vs Global Accelerator
- CloudFront
	- 변화하는 동적인 IP 주소 세트를 사용
	- 엣지 로케이션 사용
	- 엣지 로케이션을 콘텐츠를 캐시 하는데 사용함
	- http 프로토콜을 처리하는데 적합
- Global Accelorator
	- 고정된 IP주소를 사용
	- 엣지 로케이션 사용
	- 엣지 로케이션을 리전의 최적화된 경로를 찾는데 사용함
	- tcp/udp 프로토콜을 처리하는데 적합

### 스토리지 및 데이터 전송
1. AWS Storage Gateway
- 온프레미스 데이터센터의 데이터와 AWS 클라우드의 스토리지를 연결하는 서비스
- 하이브리드 클라우드 스토리지 서비스
- S3 파일 게이트웨이
	- 온프레미스와 S3 간에 파일 기반 인터페이스 제공하는 게이트웨이
	- NFS, SMB 파일 공유 프로토콜 사용
- FSx 파일 게이트웨이
	- 온프레미스와 Amazon FSx for Windows File Server 간 파일 기반 인터페이스를 제공하는 게이트웨이
	- SMB 파일 공유 프로토콜 사용
- 볼륨 게이트웨이
	- 온프레미스와 S3 간에 iSCSI 블록 스토리지 기반 인터페이스를 제공하는 게이트웨이
	- 캐시볼륨 모드
	- 저장볼륨 모드
- 테이프 게이트웨이
	- 온프레미스와 S3 간에 iSCSI VTL(가상 테이프 라이브러리) 인터페이스를 제공하는 게이트웨이
	- 기존의 온프레미스 테이프 백업 장치 구성을 변경하지 않아도 AWS S3로 백업 가능

- Storage Gateway - 하드웨어 어플라이언스 : 온프레미스 서버에 게이트웨이가 없는 경우 하드웨어를 통해서 해결 가능

2. Amazon FSx
- Amazon 파일 시스템
- 온프레미스, AWS 클라우드에서 액세스 가능
- 4가지 유형의 파일시스템 제공
- FSx for Luster
	- 리눅스 환경을 위한 고성능 병렬 스토리지 시스템
	- 머신러닝, 빅데이터 등의 고성능 컴퓨팅에 사용
	- Amazon S3 버킷과 통합 구성하여 같이 사용 가능
	- 스크래치 파일시스템 옵션
	- 지속성 파일 시스템 옵션
- FSx for NetAPP ONTAP
- FSx for OpenZFS
- FSx for Windows File Server
	- EFS는 리눅스 환경의 파일 공유 서비스
	- FSx for Windows File Server는 윈도우 서버에 구축되는 파일 공유 서비스

3. AWS Snow Family
- 데이터를 네트워크가 아닌 물리적인 장치에 저장하여 전송할 수 있는 디바이스
- 대용량의 온프레미스의 데이터를 AWS로 마이그레이션 해야할 때 사용
- 사용사례
	- 제한된 시간안에 마이그레이션
	- 1회성 마이그레이션
	- 대용량 데이터 마이그레이션에 가장 적은 시간이 소요되는 방법이 필요한 경우
	- 회사 네트워크 대역폭이나 사용제한이 있는 경우
- 디바이스 유형
- AWS Snowcone
	- 디바이스 중 가장 작은 제품
	- AWS DataSync를 통해 인터넷을 통해 AWS로 전송 가능
- AWS Snowball
	- 데이터 마이그레이션 및 엣지 컴퓨팅 서비스
- AWS Snowmobile
	- 대용량의 최대 100PB 전송
	- 데이터 센터 전체 전송 가능

4. AWS Backup
- 중앙 집중식 백업 관리 서비스
- 다양한 서비스의 백업을 중앙에서 관리함
- 리소스 태그 기반으로 백업 정책 구성 가능
- AWS Backup 구성
- 백업계획, 백업볼트 (백업 데이터가 저장되는 저장소)

5. 스토리지 서비스 비교
- S3 : 객체 스토리지, 범용적으로 다양한 용도에 사용하고 정적 웹사이트 호스팅에도 사용
- S3 Glacier, S3 Glacier Deep Archive : 데이터 아카이브 용도
- EFS : NFS 프로토콜 지원, 리눅스 네트워크 파일 시스템
- FSx for Windows : SMB 프로토콜 지원, 윈도우 네트워크 파일 시스템
- FSx for Luster : 고성능 벙렬처리, 고성능 컴퓨팅을 위한 리눅스 파일 시스템
- EBS : EC2 인스턴스에 연결 가능한 블록 스토리지, 동일 가용영역 내에서만 연결 가능
- Instance Store : 고성능 IOPS를 제공하는 특정 EC2에서 제공하는 블록스토리지, 임시 저장소 용도, 재부팅 시 데이터 사라짐
- Storage Gateway : 온프레미스와 AWS 스토리지 연결 서비스 (파일/볼륨/테이프 게이트웨이)
- Snow Family/Snowball : 온프레미스의 1회성 데이터 오프라인 AWS 마이그레이션을 위한 디바이스
- AWS Backup : 중앙직중식 백업 관리 서비스

6. AWS Transfer Family
- SFTP, AS2, FTPS, FTP 프로토콜을 통해 S3, EFS에 파일을 송수신할 수 있는 파일 전송 서비스

7. AWS DataSync
- 온프레미스 스토리지, AWS 스토리지 간 데이터 복사를 간소화, 자동화하는 데이터 마이그레이션 서비스
- AWS 서비스 내 스토리지의 데이터 이동을 위해서도 사용
- 전송 중 데이터 무결성 확인 및 암호화 가능
- DataSync 구성
- 에이전트 : DataSync 애플리케이션이 실행되는 가상머신 어플라이언스
- 위치 : 데이터를 복사할 소스와 목적지 위치
- 태스크 : 데이터를 복사하는 방법에 대한 세부 정보
- 인터넷을 통해 데이터 전송 시 TLS 암호화 수행
- 온라인으로 데이터를 전송해야할 때 사용
- 초기 데이터를 S3로 마이그레이션 할 때 사용
- 기존 여러 스토리지 시스템에서 여러 대상으로 데이터를 전송하고자 하는 경우 사용

### 디커플링 애플리케이션 : SQS, SNS, Kinesis, Active MQ

1. SQS
 -  메시지를 대기하는 기능
 - 애플리케이션 간에 느슨한 결합 제공
 - 시나리오 : 쇼핑몰 주문, 배송
 - poll 방식으로 메시지를 전송 (큐에서 먼저 보내는게 아니라 Consumer가 메시지를 요청하여 받는 방식)
 - 표준대기열
	 - 일반적인 대기열 방식
	 - 순서와 상관없이 메시지 전달
	 - 가끔 2개 이상의 복사본이 전달 될 수 있음
 - FIFO 대기열
	 - 메시지가 들어온 순서대로 처리
	 - 중복메시지 전달 없음
- DLQ 
	- 배달 못한 편지 대기열
	- 일정 횟수 이상 시도 후 처리되지 못한 메시지는 DLQ로 보관
- 제한시간초과/표시제한시간 (Visiblity Timeout)
	- 메시지소비자가 대기열에서 메시지를 수신하고 처리하면 메시지는 계속 대기열에 있음 (재전송이 필요할 수 있어서)
	- 소비자가 메시지를 수신하고 처리한 후 대기열에서 메시지 삭제
	- 대기열에 계속 있으니까 메시지 수신 후 처리 전까지 재전송 가능성을 방지하기 위해서 해당 메시지를 안보이게 차단함
	- 다른 소비자가 메시지를 수신하고 처리할 수 없도록 차단하는 기간
	- 
- Short Polling vs Long Polling
	- Short Polling은 메시지 Queue가 비어있어도 메시지 소비자의 메시지 요청을 즉시 반환하는 방법
	- Long Polling은 Queue에 미시지가 비어 있으면 Queue에 메시지가 도착할 때까지 설정한 대기시간 만큼 대기하는 방법 (빈 응답 수를 제거하여 비용, 지연시간 절감 기능)

2. SNS
- 메시지 전송 서비스
- push 방식으로 메시지를 전송 (subscriber에게 메시지를 보내는 방식)
- 전송 순서
	1. sns에서 주제 생성
	2. 구독 생성
	3. 메시지 생성
	4. 구독자에게 메시지 전달
3. SNS + SQS Fan Out
- SQS, SNS 둘 다 AWS 내 메시징 서비스
- SNS를 사용하면 폴링 할 필요 없이 푸쉬 메커니즘을 통해 다수의 구독자에게 메시지를 보낼 수 있음
- SQS는 분산 애플리케이션에서 폴링 모델을 통해 메시지를 교환, 송신 구성요소와 수신 구성요소 분리
- publisher -> sns -> sqs -> application
4. SNS FIFO Tocpic
- 메시지가 주제에 게시된 정확한 순서로 구독된 SQS FIFO 대기열에 메시지를 전달

5. Amazon Kinesis
- 실시간 스트리밍 데이터를 수집, 처리 및 분석하는 버시스
- 데이터를 수신하는대로 처리 및 분석
- 서비스 유형
	- Kinesis Data Streams : 데이터를 수집, 저장 및 처리
		- 실시간 서비스
		- 데이터 스토리지가 있음
	- Kinesis Data Firehose : 데이터 스트림을 AWS 데이터 스토어에 로드
		- 스트리밍 데이터 캡쳐 및 변환 후 데이터 레이크, 데이터 스토어 및 분석 도구에 로드하는 서비스
		- 스트리밍 ETL 솔루션
		- 거의 실시간 서비스
		- 데이터 스토리지가 없음
	- Managed Apache Flink(Kinesis Data Analytics) : Apache Flink로 데이터 스트림 분석
	- Kinesis Veideo Streams : 비디오 스트림 수집

6. Amazon MQ
- Apache ActiveMQ 및 RabbitMQ용 관리형 메시지 브로커 서비스
- 다른 메시지 관리 서비스를 사용할 수 있게 브로커
- active/stanby 브로커 배포모드를 지원하여 고가용성 및 장애조치 가능
- 클라우드 기반의 애플리케이션은 SNS, SQS 메시지 서비스를 사용하는 것을 추천
- 기존에 ActiveMQ, RabbitMQ를 사용하고 있었을 때 AmazonMQ 사용

7. API Gateway
- 서버리스 API 서비스
- 애플리케이션 백엔드 서비스의 기능에 액세스 하는 API를 쉽게 생성 및 관리 기능
- RESTful API 및 WebSocket API를 지원
- API 엔드포인트 유형
	- Edge-Optimized(엣지 최적화) : 글로벌 클라이언트를 위한 옵션으로 가장 가까운 엣지로케이션으로 라우팅
	- Regional(리전) : 동일 리전 라우팅
	- Private(프라이빗) : VPC 내에서만 라우팅
- IAM 역할, Congino, HTTPS 등의 보안 적용 가능
- 통합사례
	- 람다 코드 실행 : client -> api gatewayty -> lambda -> dynamoDB
	- kinesis로 데이터 전송 : client -> api gateway -> kinesis data stream -> data firehose -> S3
	- AWS 외부의 웹 서비스를 호출

8. AWS Step Functions
- 시작적 워크플로 구축 서비스
- 애플리케이션의 구성 요소를 단계별로 배열하여 다단계 애플리케이션을 구축하고 실행
- 사용예
	- 데이터처리 : 여러 데이터베이스의 데이터를 통일된 보고서로 통합, 분석 가능
	- Devops 및 IT 자동화
	- 전자상거래 : 주문처리, 재고추적 등 프로세스 자동화
	- 웹 애플리케이션 : 강력한 사용자 등록 프로세스와 로그인 인증 구현

9. Amazon AppFlow
- Saas 애플리케이션과 AWS 간에 안전하게 데이터를 전송할 수 있게 해주는 서비스
- Saas 애플리케이션과 데이터를 교환하기 위해 AWS 서비스 용 API 커넥터를 구축하고 관리할 필요 없음

10. Amazon EventBridge
- 이벤트 데이터를 전송하는 서비스
- 코드 작성 없이 이벤트 데이터를 실시간으로 자동 전송할 수 있음
- Saas 애플리케이션 또는 AWS 서비스의 이벤트에 반응하는 애플리케이션을 구축하려고 할 때 사용
- 사용사례
	- AWS 리소스의 구성 변경, 규정 비준수 사항을 SNS 주제에 메시지를 게시하여 관리자에게 알림
	- S3 버킷에 있는 민감한 데이터 발견 시 다른 서비스로 알림


### 컴퓨팅 - 컨테이너 서비스
1. AWS 컨테이너 서비스
- Elastic Container Service(ECS)
	- Docker 컨테이너를 배포, 관리하는 컨테이너 오케스트레이션 서비스
-  Amazon Elastic Kubernetes Service(EKS)
	- AWS에서 Kubernetes를 실행하는 서비스
	- 쿠버네티스 오케스트레이션 서비스
- AWS Fargate
	- 서버리스 컨테이너 서비스
	- 서버 프로비저닝, 패치 적용, 클러스터 용량 관리 또는 인프라 관리를 AWS에서 자동으로 수행
	- ECS, EKS와 연동되는 서비스
- Amazon Elastic Container Registry(Amazon ECR)
	- Docker 등의 컨테이너 이미지를 공유, 배포 등의 관리 서비스
	- ECR에서 공유된 이미지를 사용하여 ECS, EKS에서 컨테이너 구성

2. Elastic Container Service(ECS)
- AWS에서 도커를 실행하는 서비스
- 용량 요구 사항에 따라 오토 스케일링 가능
- ALB, NLB를 사용하여 트래픽 분산 가능
- CloudWatch Container Insights를 사용하여 서비스의 지표 및 로그 수집 가능
- ECS 클러스터 시작 유형
	- Fargate 시작유형
		- 서버리스 방식으로 ECS 호스팅
	- EC2 시작유형
		- ECS 클러스터를 EC2에 등록하여 사용
	- ECS Anywhere
		- 온프레미스 환경에서 사용

4. Elastic Kubernetes Service(EKS)
- AWS에서 쿠버네티스를 실행하는 서비스
- CPU또는 사용자지정지표를 기반으로 Pod 자동 규모 조정, 클러스터 자동 규모 조정을 지원
- ALB, NLB를 사용하여 트래픽 분산 가능
- 사용사례
	- 고가용성 애플리케이션 배포
	- MSA 아키텍처 구축
	- SW 릴리스 자동화
- 배포 옵션
	- 클라우드 Amazon EKS : AWS에서 관리하는 쿠버네티스 클러스터를 배포
	- Outpost Amazon EKS : 쿠버네티스 컨트롤 플레인이 AWS 리전에서 실행되고 노드가 Outpost에서 실행
	- Amazon EKS Anywhere : 온프레미스에서 클러스터 운영/배포
	- Amazon EKS Distro : 오픈소스 기반의 클러스터를 생성/운영/배포
- 노드(컨테이너화된 컴퓨팅 시스템) 유형
	- EKS 관리형 노드 그룹
		- 사용자가 보안 및 업데이트의 일부분을 설정/관리 가능
	- 자체관리형 노드
		- 사용자가 직접 EKS 노드를 생성/관리
	- AWS Fargate
		- 노드 관리를 전부 AWS에서 담당


### 컴퓨팅 - 기타
1. 서버리스
- 서버를 사용가 관리할 필요가 없다는 의미
- 대표적인 AWS 서버리스 서비스
	- AWS 람다, AWS Fargate
	- S3, DynamoDB, Amazon Aurora Serverless
	- SNS, SQS, API Gateway

2. 람다
- 코드를 실행하여 동작하는 서버리스 컴퓨팅 서비스
- 사용자는 코드를 입력해서 실행만 하면 됨
- 요청할 때만 시스템을 사용하는 온디맨드 방식의 실행
- 코드를 실행한 횟수와 시간으로 과금
- 사용량이 늘어나면 자동으로 용량이 확장되므로 오토스케일링 등 용량확장 계획을 세울필요 없음
- 람다함수는 실행 당 최대 15분 동안 하도록 구성
- 사용사례
	- 빠르게 스케일업해야하고 수요가 없을 때는 0으로 스케일 다운해야하는 애플리케이션
	- 파일처리
	- 스트림처리
	- 웹 애플리케이션
	- IOT/모바일백엔드

3. 람다 - 동시성
- 동시에 처리하는 최대 함수 실행 수 : 1000건
- 두 가지 유형의 동시성 제어 : 중요한 함수가 필요한 동시성을 확보하도록 동시성 설정을 구성
	- 예약된 동시성 : 
		- 람다함수에 예약된 최대 실행 환경 수
		- 추가요금없음
	- 프로비저닝된 동시성 : 
		- 함수에 할당하려는 사전 초기화된 실행 환경의 수
		- 함수의 요청에 즉시 응답할 준비가 되도록 해당하는 수의 실행환경을 초기화 : 콜드스타트
		- 추가요금발생

4. AWS Elastic Beanstalk
- 웹 애플리케이션 및 서비스를 배포하고 운영하는 서비스
- 사용자가 직접 인프라 리소스를 구성할 필요가 없고 애플리케이션 코드에만 집중하면 됨
- 인프라에 대한 지식이 없어도 배포 가능
- 코드를 업르도하기만 하면 Elastic Beanstalk가 용량 프로비저닝, 로드 밸런싱, 오토 스케일링부터 시작하여 애플리케이션 상태 모니터링 배포를 AWS에서 자동으로 처리
- 구성요소
	- 애플리케이션
	- 애플리케이션 버전
	- 환경

5. AWS Batch
- 배치 컴퓨팅 워크로드를 실행하는 서비스
- Docker 컨테이너로 실행될 수 있는 모든 작업을 지원
- 구성요소
	- 작업
	- 작업정의
	- 작업대기열
	- 컴퓨팅환경

### 데이터베이스
1. RDS
- DB다운타임 없이 스토리지 용량 만큼 자동으로 확장 가능(오토스케일링)
- 3가지 데이터베이스 스토리지 유형
	- 범용 SSD 스토리지 : 일반적인 용도
	- 프로비저닝된 IOPS SSD 스토리지 : 빠른 I/O가 필요한 경우 사용
	- 마그네틱 스토리지 : 액세스 빈도가 낮은 경우 사용
2. RDS 백업
- 자동 백업 및 데이터베이스 스냅샷 제공
- 자동 백업
	- 백업을 수행하는 백업 기간을 설정
	- 보존 기간은 1일부터 35일까지 설정 가능
	- DB인스턴스를 특정 시점으로 복구 가능(Point in time recovery)
	- 5분마다 백업 수행
- 데이터베이스 스냅샷
	- 사용자가 수동으로 스냅샷 생성 가능
	- 사용자가 지정한 만큼 백업을 보존할 수 있음
- 복구 시 새로운 DB인스턴스에 복구함
- 스냅샷과 자동 백업은 S3에 저장함
3. RDS 보안
- SSL/TLS를 사용하여 애플리케이션과 DB인스턴스 간에 전송 중 암호화 가능
- KMS를 통해 관리하는 키를 사용하여 암호화 가능
- 암호화 되지 않은 DB 인스턴스 암호화
	- RDS 인스턴스 스냅샷 생성
	- 암호화 된 스냅샷 복사본 생성
	- 암호화 된 스냅샷에서 RDS 인스턴스 복원
- 암호/패스워드 이외에 IAM 사용자 및 역할을 통해 데이터베이스 인증 적용 가능
- RDS에 보안그룹 연결 가능
- Audit Logs 기능을 사용하여 보안 감사에 활용 가능, CloudWatch Logs 도 활용 가능
4. RDS - 읽기 전용 복사본
- 읽기만 가능한 DB 인스턴스의 복제본을 여러개 만드는 기능
- 읽기 전용 복제본이 작동하려면 백업이 활성화된 상태로 유지되어야 함
5. RDS - 다중 AZ
- 데이터베이스를 여러 가용영역에 배치하는 것
- 원본 DB를 복제해서 다른 가용영역에 생성
- 동기식으로 복제 수행
- 읽기 전용 복사본 처럼 복제본을 읽기 용으로 사용할 수는 없음
6. RDS - RDS Custom
- 사용자가 데이터베이스와 운영체제에 대한 관리 권한을 가짐
7. RDS - Proxy
- 데이터베이스 프록시 기능
- 애플리케이션이 데이터베이스와 연결 풀링하고 공유하도록 하는 기능
- 여러 애플리케이션이 연결에서 데이터베이스 연결을 공유할 수 있으므로 리소스를 효율적으로 사용 가능
- 데이터베이스 장애 조치 시간 감소 : 애플리케이션 연결을 유지하면서 예비 DB인스턴스에 자동으로 연결
- 보안 개선 : 데이터 베이스 성능 유지 : 매번 새 데이터베이스 연결을 열 필요 없음, 최대 연결 수 제어 가능

8. Aurora
- RDS 호환형 관계형 데이터베이스
- 읽기전용복제본, KMS암호화, 스냅샷 백업, 오토스케일링 제공
- 다른 RDS 보다 저렴하고 성능이 뛰어남
- 여러 인스턴스를 하나로 관리하는 클러스터 DB 기반으로 구성됨
- Aurora DB 클러스터
	- 하나 이상의 DB 인스턴스와 이 DB인스턴스의 데이터를 관리하는 클러스터 볼륨으로 구성
	- DB인스턴스는 기본 DB인스턴스와 읽기 작업만 하는 복제본으로 구성
	- 각 Aurora 클러스터는 최대 15개까지 복제본 구성
- Aurora 복제본
	- 3개의 가용영역에 6개의 데이터 사본을 자동 복제
	- 마스터 DB와 최대 15개의 읽기 전용 복제본 지원
	- 복제본을 통한 장애조치 수행
	- RDS는 다중 AZ RDS를 통해 장애조치를 수행해야하지만 Aurora는 복제본이 자동으로 마스터DB로 승격
- Aurora 글로벌 데이터베이스
	- 다른 리전으로 데이터베이스 복제하는 기능
	- 1초 미만의 대기시간으로 최대 5개의 보조리전에 복제
- Aurora Database Cloning
	- 새 Aurora DB 클러스터를 생성하는 기능
	- 운영 클러스터를 복제하여 테스트, 개발 용도의 클러스터를 생성
- Aurora Machine Learning
	- Amazon SageMaker 또는 Amazon Comprehend 서비스와 통합하여 사용 가능
	- 데이터로 학습해서 추천 등 기능 사용
- Aurora 멀티 마스터 클러스터
	- 모든 DB인스턴스가 쓰기 작업 수행 가능
	- 단일 마스터 클러스터에 비해 장애조치 지연시간이 없음
- Aurora Serverless
	- DB 인스턴스 운영 및 관리 하지 않음
	- 사용한만큼만 DB용량을 초당 요금으로 지불
	- DB 사용용도가 낮은 애플리케이션에서 사용

9. ElastiCache
- 인메모리 데이터스토어
- 1밀리 초 미만의 빠른 응답시간
- 빠른 응답이 필요한 애플리케이션에 사용
- 기존의 DB에 연결해서 사용
- ElastiCache를 사용하기 위해서는 애플리케이션 코드변경 필요
- 오픈소스 인메모리 데이터베이스 솔루션인 Redis, Memcached 두가지 유형 지원
- 일반적인 기능은 Redis가 지원을 더 많이 하지만 Memcached는 멀티 쓰레드 지원함

10. DynamoDB
- NoSQL 데이터베이스 서비스
- 키-값, 문서 데이터 모델 지원 
- 서버리스 서비스
- 오토스케일링 기능 지원
- RDS에 비해 빠른 10밀리 초 미만의 빠른 응답을 제공
- 지연시간이 짧은, 빠른 응답이 필요한 애플리케이션에 사용
- 백업 및 복구
	- DB테이블에 대해 온디맨드 백업을 생성하고 특정 시점으로 복구를 활성화
	- 특정 시점으로 복구 PITR를 사용해 최근 35일 이내 원하는 시점으로 복구 가능
- DynamoDB 테이블 클래스
	- Standard : 기본형으로 대부분의 워크로드에 권장
	- Standard-IA : 자주 액세스 하지 않는 데이터
- 읽기/쓰기 용량 모드
	- 온디맨드 모드
	- 프로비전드 모드
- DynamoDB Accelerator (DAX)
	- 데이터베이스 앞에 인메모리 캐시를 사용해서 DB의 성능을 향상시키는 기능
- TTL(Time To Live)
	- 유지시간을 사용해서 항목별 타임스탬프를 정의하여 항목이 더 이상 필요하지 않는 시점을 결정
	- 지정된 타임스탬프가 지나면 자동으로 항목 삭제
- 글로벌테이블
	- 리전간에 데이터베이스를 복제하는 기능
	- 모든 리전에서 읽기/쓰기 가능
- DyanmoDB Streams
	- DB 테이블에 항목의 변경이 발생하는 경우 변경 사항을 캡쳐하는 기능
	- 변경사항을 Kinesis Data Stream으로 보낼 수도 있고 람다로 트리거 해서 SNS 전송 등 기능을 처리할 수 있음
- 읽기 일관성
	- 최종적 일관된 읽기 : 최근 완료한 쓰기 결과를 반영하지 못할 수 있음
	- 강력한 일관된 읽기 : 있음
- Amazon S3와 통합
	- S3로 내보내기 : 
		- 자동 백업 설정된 데이터만 보낼 수 있음, 
		- JSON/Ion 텍스트 형식으로만 내보낼 수 있음
	- S3에서 가져오기

11. Other Databases
- DocumentDB
	- 몽고DB 호환하는 데이터베이스
- Amazon Keypaces
	- 아파치 카산드라 호환 데이터베이스
- Amazon Neptune
	- 그래프 데이터베이스 서비스
	- 노드들의 관계들로 이루어진 데이터베이스
- Amazon Quantum Ledger Database (Amzon QLDB)
	- 원장(Ledger) 데이터베이스
- Amazon Timestream
	- 시계열 데이터베이스 서비스
	- 시간에 따라 저장된 데이터(IOT)

12. Database Migration Service (DMS)
- 데이터베이스를 마이그레이션 하는 서비스
- 온프레미스 간, AWS 간 모두 가능
- 서로 다른 종류 DB도 마이그레이션 가능

### 데이터 분석 서비스
1. Amazon Ahtena
- 표준 SQL을 사용해서 S3에 저장된 데이터를 분석할 수 있는 쿼리 서비스
- Athena로 데이터를 로드할 필요 없이 S3에 저장된 데이터를 직접 사용
- 쿼리 수행 후 Amazon QuickSight와 통합하여 쿼리된 데이터를 시각화 할 수 있음

2. Amazon Redshift
- 데이터웨어하우스 서비스
- 데이터 웨어하우스는 의사결정을 위한 정보의 집합
- 여러 소스로 부터 얻은 구조화되거나 반 구조화된 대량의 데이터를 중앙 집중화 및 통합하여 데이터 웨어하우스의 분석 기능을 통해 비즈니스 통창력 도출
- 다양한 데이터 소스에서 Amazon Redshift로 데이터를 로드

3. Amazon OpenSearch Service (Amazon ElasticSearch Service)
- 로그 분석, 실시간 애플리케이션 모니터링 및 웹사이트 검색을 쉽게 수행할 수 있게 해주는 서비스
- 다양한 소스에서 스트리밍 데이터를 OpenSearch Service 도메인으로 로드
- Kinesis Data Firehose 및 CloudWatch Logs와 같은 일부 소스는 OpenSearch Service를 기본으로 지원
- S3, Kinesis Data Streams, DynamoDB 등 다른 소스는 람다 함수를 이벤트 핸들러로 사용하여 로드

4. AWS QuickSignt
- 클라우드 기반의 비즈니스 인텔리전스 도구
- 대시보드, 그래프 등의 시각화를 통한 데이터분석을 통해 의사결정을 도와주는 서비스
- 다양한 데이터 소스와 연결 가능

5. Glue
- 데이터분석을 위한 ETL(Extract, Transform and Load) 서비스, 추출/변환/로드
- 다양한 소스에서 데이터 검색 및 추출, 데이터 강화, 정리, 정규화 및 결합 작업 등 수행

6. AWS Lake Formation
- 데이터 레이크 서비스
- 데이터 레이크는 구조화되지 않은 유형도 포함하여 모든 유형의 대량의 데이터를 저장, 처리, 보호 하는 중앙 집중식 서비스 (데이터 웨어하우스는 구조화되지 않은 유형은 포함 안함)

7. Amazon EMR (Elastic MapReduce)
- 클라우드 빅데이터 플랫폼
- MapReduce는 분산 병렬처리 컴퓨팅 모델의 이름
- EMR은 빅데이터 플랫폼인 Hadoop 클러스터를 손쉽게 생성해주는 서비스
- 머신러닝, 빅데이터 처리 등에 사용

### 머신러닝
1. Comprehend
- 텍스트 안에서 특정 항목을 찾아내는 서비스
- 분석보고서에서 회사 이름 찾기, 부정적인 후기 또는 고객 서비스 상담사와의 긍적적인 고객 상담
2. Rekognition
- 이미지, 비디오 분석 (이미지에서 얼굴 탐지, 사물 인식)
3. Polly
- 텍스트를 음성으로 변환하는 서비스 (TTS)
4. Lex
- 음성인식 서비스, 챗봇 구현 가능
5. Textract
- 스캔 문서에서 문자, 테이블, 양식 추출 서비스
6. Translate
 - 번역서비스
7. Transcribe
- 음성을 텍스트로 변환
8. SageMaker
- 머신러닝 모델을 구축, 훈련 및 배포 하는 서비스
9. Forecast
- 머신러닝을 기반으로 하며, 비즈니스 지표 분석을 위해 구축된 시계열 예측 서비스
10. Kendera
- 지능형 검색 서비스
- 간단한 키워드 외에도 자연어 질문을 사용하여 원하는 답을 얻을 수 있으며 텍스트 조각이든, FAQ이든, PDF문서이든 관계없이 문서 내에서 정확한 답변을 반환
11. Personalize
- Amazon.com에서 실시간 맞춤화 추천에 사용하는 것과 동일한 기계학습 기술로 애플리케이션을 구축 가능한 서비스
- 특정 제품 추천, 맞춤화 된 제품 순위 재지정, 맞춤화된 직접 마케팅을 포함하여 다양한 맞춤화 환경을 제공할 수 있는 애플리케이션을 손쉽게 구축 가능
12. Amazon Connect
- 클라우드 기반 고객센터 서비스
- 전화통화, 자동 음성응답, 챗봇 등의 기술 통합 가능


### 관리 및 거버넌스
1. AWS Organizations
- 여러 AWS 계정을 중앙에서 관리
- 리전 서비스가 아닌 글로벌 서비스
- 전체 계정을 관리하는 계정을 관리계정(Master Account)라고 함
- 그 외의 계정은 멤버 계정
- 조직 관리를 위해 OU(Organization Unit)이라는 조직 단위로 그룹화 하여 관리
- 그룹마다 서비스 제어 정책(SCP, Service Control Policy)를 적용해서 액세스를 제한 해야 하는 서비스를 제어할 수 있음
- 계정을 통합하면 결제를 한곳으로 통합하고 가격 할인 가능
2. Oraganizations - OU
- 조직 단위로 그룹화하여 관리하는 기능
- 사용중인 AWS 계정을 Root OU로 초대하여 멤버 계정으로 만들 수 있음
3. Organizations - SCP
- 서비스 제어 정책
- 계정에 대한 AWS 서비스 액세스 제어 정책
- SCP 정책은 계정 또는 OU 단위에 적용할 수 있음
- 하위 그룹도 상위 그룹의 정책 적용됨

4. Amazon CloudWatch
- AWS 클라우드 리소스와 애플리케이션을 위한 모니터링 서비스
- 지표를 수집 및 추적하고 로그 파일 수집, 경보 설정
- 시스템 전반의 리소스 사용률, 성능, 운영 상태 파악
- 지표
	- 리소스, 애플리케이션 모니터링
	- CPU 사용량, 네트워크 사용량 측정값
- 대시보드
	- 그래프로 한눈에 볼 수 있는 대시보드 기능
- 로그
	- 애플리케이션에 대한 로그를 수집하는 기능
	- 람다, CloudTrail, ECS, API Gateway 등의 AWS 서비스에 대한 로그를 수집
	- AWS 서비스 이외에도 Log Agent를 설치하여 로그 수집 가능
	- 수집한 로그를 S3, Kinesis Data Stream, Kinesis Data Firehose, AWS 람다로 전송 가능
- 경보
	- 지표값에 대한 알림을 생성하는 기능

5. AWS CloudTrail
- AWS 계정이 수행하는 작업(사용자, 역할 또는 AWS 서비스가 수행하는 작업)을 CloudTrail에 이벤트(로그)로 기록하는 서비스
- 이벤트에는 AWS Management Console, AWS CLI, SDK, API에서 수행되는 작업도 포함됨
- AWS 계정의 거버넌스, 규정준수, 운영감사, 위험감사에 활용
- CloudTrail은 모든 계정에 기본으로 상시 활성화 되어 있음
- 로그 파일은 KMS를 사용하여 암호화 가능
- 로그 파일 무결성 검증 기능을 사용하여 로그 파일을 S3 버킷으로 전송한 이후 파일이 수정되거나 삭제되었는지 확인 가능
6. CloudTrail 이벤트 유형 3가지
- 관리 이벤트
	- AWS 계정의 리소스에 대해 수행되는 관리(컨트롤) 작업에 대한 정보
- 데이터 이벤트
	- 리소스 작업에 대한 정보 (읽기, 쓰기)
- 인사이트 이벤트
	- 관리활동을 분석하여 사용자의 AWS 계정에서 비정상적인 활동을 캡처
7. CloudTrail 데이터 보관 및 분석
- 이벤트 기록
	- AWS 리전에서 발생한 90일 간의 이벤트 기록
- CloudTrail Lake
	- 감사 및 보안 목적으로 AWS에서 사용자 및 API 활동을 캡처, 저장, 액세스, 분석하기 위한 관리형 데이터 레이크
	- 최대 7년 동안 데이터스토어에 보관 가능
	- S3 버킷에서 가져오기 가능
	- Lake 대시보드를 사용하여 주요 트렌드 시각화 가능
- 추적
	- AWS 활동 기록을 캡처하여 이러한 이벤트를 S3 버킷에 저장
	- CloudWatch Logs 및 Amazon EventBridge로 이벤트 전송 가능

8. AWS Config
- AWS 리소스 구성 및 변경 사항을 로그기록 하는 기능
- 예, 버킷 액세스 변경, 보안그룹 설정변경, ALB 설정 변경 등 모든 AWS 구성 변경 사항에 대해 로그 수집
- 규정 준수 감사, 보안 분석에 사용
- S3 버킷으로 전송 가능
- 리소스 구성변경이 발생되면 SNS 주제로 전송 가능
- Config 규칙을 설정해서 규정준수를 하고 있는지 평가 가능
9. AWS Config 사용 사례
- 리소스 구성설정을 평가하여 리소스 관리
- 감사, 보안 및 규정 준수
- 구성 변경 관리 및 문제 해결
- 보안 분석

10. AWS Systems Manager (SSM)
- AWS 클라우드에서 실행되는 애플리케이션 및 인프라를 관리하는데 도움이 되는 기능 모음
- AWS 서비스의 운영 데이터를 중앙집중화
- System Manager 기능
	- 애플리케이션 관리
	- 변경 관리
	- 노드 관리
	- 운영 관리

### 보안 및 자격 증명
1. Cognito
- 웹 및 모바일 앱을 위한 자격 증명 서비스
- 로그인 및 인증을 제공하는 기능
- 소셜ID 공급자 및 SAML 또는 OIDC 기반 ID 공급자를 통한 로그인 지원

2. AWS IAM Identity Center (AWS SSO)
- 싱글사인온 서비스
- SSO는 중앙에서 관리하는 하나의 계정으로 여러 애플리케이션에 로그인하는 기능
- SAML은 인증을 지원하기 위한 표준 데이터 포맷

3. AWS Directory Services
- Microsoft Active Directory (Microsoft AD) : 사용자, 컴퓨터, 서버 등의 정보와 인증을 중앙에서 관리하기 위한 서비스 집합
- AWS Directory Service는 다른 AWS 서비스에서 Microsoft AD를 사용할 수 있게 하는 기능
- 디렉터리는 사용자, 그룹 및 디바이스에 대한 정보를 저장하고, 관리자는 이를 사용하여 정보 및 리소스에 대한 액세스를 관리
- AWS Directory Service 옵션
	- AWS Directory Service for Microsoft AD(AWS Managed Microsoft AD)
		- AWS 클라우드에서 Microsoft AD를 관리하여 서비스로 실행
	- AD Connector
		- 온프레미스로 Microsoft AD로 디렉토리 요청을 리디렉션 할 수 있는 디렉터리 게이트웨이
		- AWS 서비스와 함께 기존의 온프레미스 디렉터리를 사용하고 싶을 때 적합한 옵션
	- Simple AD
		- Samba 4 Active Directory 호환 디렉터리

4. AWS Key Management Service (KMS)
- 3가지 암호화 방법
	- 전송중 암호화 : 네트워크로 전송하는 트래픽을 암호화(SSL/TLS)
	- 서버측 암호화 : 서버에 저장된 데이터를 암호화
	- 클라이언트측 암호화 : 데이터를 보내기전에 암호화
- 암호화 키를 생성하고 관리하는 서비스
- EBS, S3, RDS 등의 AWS 서비스 데이터 암호화에 KMS 사용
- 키를 자동교체하는 기능 지원
- 감사를 위해 AWS CloudTrail과도 통합되어 모든 키 사용에 관한 로그 지원
- 3가지 유형의 키 제공
	- 고객 관리형 키 : 사용자가 생성, 소유 및 관리하는 키, 제어 권한을 사용자가 가짐
	- AWS 관리형 키 : AWS 서비스가 고객 대신 생성 및 관리, 제어 권한이 없거나 제한이 있음
	- AWS의 키 : AWS 서비스가 AWS 계정에서 사용하기 위해 소유하고 관리하는 KMS 키 모음

5. CloudHSM
- KMS는 소프트웨어 방식의 암호화
- CloudHSM은 AWS에서 제공하는 하드웨어 암호화 장비를 통한 하드웨어 방식의 암호화
- KMS와 달리 암호화 키 관리는 사용자가 직접 해야함(고객제공키에 적합한 방식)

6. KMS 다중 리전 키 (Multi-Region Keys)
- 여러 리전에서 동일한 키를 가지고 있는 것
- 하나의 AWS 리전에서 데이터를 암호화 하고 다른 리전에서 복호화 가능
- 다이나모디비 글로벌 테이블 및 멀티리전의 복제된 S3 버킷의 암호화 등에 사용

7. AWS Secrets Manager
- 보안 정보(자격증명)를 중앙 집중식으로 저장, 검색, 액세스 제어, 교체, 감사 및 모니터링 하는 서비스
- 보안정보는 데이터베이스 자격증명, 온프레미스 리소스 자격 증명, SaaS 애플리케이션 자격 증명, 타사 API 키 및 SSH 키 등이 될 수 있음
- 보안정보를 유지하는 방법
	- 사용자가 KMS에 저장한 암호화 키를 사용해 저장 보안 정보를 암호화
	- IAM 정책을 사용하여 보안 정보에 대한 액세스를 제어
	- 보안정보를 검색하면 시크릿매니저가 해당 정보를 복호화하여 TLS로 안전하게 로컬 환경으로 전송
- 보안정보를 자동으로 교체 및 관리 가능
	- RDS, Redshift, DocumentDB와 기본적으로 통합되며 사용자 대신 이러한 데이터베이스 자격증명을 자동으로 교체
	- 람다코드와 통합하여 자동교체 날짜를 지정하여 실행 가능

8. AWS Certificate Maneger (ACM)
- AWS 리소스에 사용할 공인 및 사설 SSL/TLS 인증서를 관리 및 배포하는 서비스
- 인증서 구매, 업로드, 갱신하는 수동 프로세스를 간편히 처리 가능
- 인증서 만료 전 ACM에서 자동으로 갱신 가능
- ACM 인증서 유형
	- 공인인증서, 사설인증서, 가져온인증서(서드파티인증서)
- ACM 인증서를 사용할 수 있는 AWS 서비스
	- ELB, CloudFront, API Gateway, CloudFormation, Elastic Beanstalk, Nitro Enclaves

9. Shield
- 애플리케이션을 디도스 공격으로부터 보호
- 실드 유형
	- 실드 스탠다드 : 모든 AWS 사용자에게 적용되어 있음 (무료), SYN/UDP Flood 등 기본적인 디도스 공격 보호
	- 실드 어드밴스드 : EC2, ELB, CloudFront, Route53 등에서 정교한 디도스 보호 제공

10. WAF - Web Application Firewall
- 웹 애플리케이션을 보호하는 방화벽
- http 계층에서 동작
- ALB, API Gateway, CloudFront에 적용 가능
- 기능
	- 악성 IP 주소 차단
	- 특정 국가의 액세스 차단
	- SQL Injection, XSS 방어
	- 속도기반 규칙으로 디도스 공격 방어
	- AWS WAF Bot Control : 스크래퍼, 스캐너 및 크롤러와 같은 봇을 쉽게 차단하거나 비율을 제한
	- Fraud Control(계정탈취방지)

11. AWS Firewall Manager
- 방화벽 규칙을 중앙에서 구성 및 관리할 수 있는 서비스
- 중앙의 관리자 계정에서 방화벽 규칙을 수립하고, 보안 정책을 생성하며, 전체 인프라에 걸쳐 중앙에서 적용 가능
- 관리 가능한 방화벽 규칙
	- WAF 규칙
	- 실드 어드밴스드 규칙
	- VPC 보안그룹
	- AWS Network Firewall 규칙
	- Route53 Resolver DNS Firewall 규칙
	- Marketplace 서드파티 방화벽 규칙

12. GuardDuty
- AWS 계정 및 워크로드에서 악의적 활동을 모니터링하고 상세한 보안 결과를 제공하는 위협 탐지 서비스
- 탐지만 하고 실제 방어는 못함. 탐지 결과를 CloudWatch Events로 전달하여 알림 발생

13. Amazon Macie
- 데이터 보안 및 데이터 프라이버시 서비스로서, 기계 학습 및 패턴 일치를 활용하여 AWS에서 민감한 데이터를 검색하고 보호

14. Amazon Inspector
- EC2 및 컨테이너 워크로드에서 소프트웨어 취약성과 의도하지 않은 네트워크 노출을 지속적으로 스캔하는 자동화된 취약성 관리 서비스

### 네트워크 - Virtual Private Cloud (VPC)
1. CIDR
- IP주소 범위를 정의하는 방식
- IP주소를 작은 그룹으로 분할 하는 것을 서브네팅이라고 함

2. VPC
- AWS의 가상 네트워크
- AWS 서비스의 네트워크 연결을 제어하는 기능
- AWS 계정을 생성하면 기본 VPC 네트워크가 생성됨
- 기본 VPC는 인터넷과 연결되어 있고 EC2 인스턴스를 생성하면 자동으로 연결됨

3. VPC 구성
- 리전 안에 VPC 구성(리전 단위로 VPC 생성)
- VPC를 서브넷으로 분할하여 가용영역 별로 사용함, 서브넷 1개당 1개의 가용영역만 지정 가능
- EC2는 Private Service로 VPC 내부에 위치
- AWS Public Services 는 VPC 외부에 위치하며 인터넷으로부터 액세스 가능한 서비스(S3, 다이나모DB, WorkSpaces)
- 프라이빗 네트워크에서 퍼블릭 네트워크로 바로 접속은 못함

4. Custom VPC 
- AWS CLoud
- VPC
- AZ A (Public Subnet)
- AZ B (Private Subnet)
- Public Subnet과 Private Subnet은 NACL과 라우팅테이블을 통해서 연결
	- 라우팅 규칙을 통해 네트워크 트래픽이 전송되는 위치를 결정
- Subnet 내에는 보안그룹 설정
- 라우팅테이블과 IGW(인터넷 게이트웨이)를 연결해서 외부 인터넷과 통신
- 라우팅테이블을 대상, 타겟 설정을 통해 퍼블릭 서브넷만 인터넷게이트웨이와 연결되도록 할 수 있음

5. NACL
- 서브넷과 연결되는 서브넷 레벨의 방화벽
- 서브넷 내부와 외부의 트래픽을 제어
- 하나의 NACL은 여러 서브넷과 연결 가능
- 하나의 서브넷은 하나의 NACL만 연결 가능
- NACL은 허용, 거부 규칙 모두 지정 가능
- 연결 상태를 추적하지 않는 상태 비저장 방화벽
- EC2 웹서버 운영 시 외부에서 클라이언트가 접속 후 리턴 트래픽을 받을 때 NAT를 사용하므로 임시포트 1024-65535를 사용
- NACL 규칙 번호
	- 가장 낮은 번호가 지정된 규칙부터 시작해서 트래픽이 내부 또는 외부로 전달되도록 허용되는지 결정
	- 번호가 가장 낮은 규칙부터 평가됨

6. 보안그룹
- 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어하는 가상 방화벽 역할
- 서브넷 수준이 아니라 인스턴스 수준에서 작동
- 하나의 EC2 인스턴스 ENI에 5개까지 보안그룹연결 가능
- 보안그룹은 허용 규칙만 지정 가능하고 거부 규칙은 지정할 수 없음
- 보안그룹은 연결상태를 추적하는 상태저장 방화벽
- 보안그룹은 생성된 VPC내에서만 사용 가능

7. NAT Instance
- 프라이빗 IP를 가진 인스턴스를 인터넷으로 트래픽을 보내기 위해 사용
- 프라이빗 서브넷 -> 라우팅 테이블 -> NAT Instance -> 인터넷
- 퍼블릭 서브넷에 NAT 기능을 설치하여 사용
- 사용자가 직접 EC2에 NAT 기능을 구성해야함

8. NAT Gateway
- NAT Gateway를 퍼블릭 서브넷에 구성하여 사용
- 프라이빗 서브넷 -> 라우팅 테이블 -> NAT Gateway -> 인터넷
- EC2에 구성하지 않고 AWS에서 제공하고 관리하는 서비스
- 사용자가 직접 구성하지 않기 때문에 Port Forwading 등의 사용자 추가 기능 사용 못함
- 고가용성 지원
- NAT Gateway에 보안 그룹 적용 불가
- NAT Gateway 생성 시 Elastic IP를 지정해야 하며 하나의 EIP 주소만 NAT 게이트웨이에 연결 가능

9. VPC Peering
- VPC 간에는 기본적으로 네트워크 통신이 되지 않음
- VPC 피어링을 통해 두 VPC 간에 트래픽을 라우팅할 수 있도록 네트워킹 연결
- VPC 피어링 트래픽은 퍼블릭 인터넷을 통과하지 않고 프라이빗 IP 주소를 사용하여 서로 통신
- VPC 피어링은 같은 리전 내에, 다른 리전 간, 다른 AWS 계정 간 가능
- 구성 방법
	- 요청자가 다른 VPC와 피어링 하기 위한 요청 생성
	- 수락자 VPC 소유자가 VPC 요청을 수락하여 피어링을 활성화
	- 라우팅 테이블에 피어링 연결을 추가
- 지원되지 않는 VPC 피어링 구성
	- CIDR Overlapping (CIDR 중첩) : 일치하거나 중첩되는 IPv4 CIDR 블록이 있는 VPC 간에는 VPC 피어링 연결을 만들 수 없음
	- Transitive Peering (전이적 피어링) : VPC B, VPC C가 VPC A를 통해 서로 라우팅 할 수 없음, 1:1 연결만 가능

10. VPN
- 인터넷을 이용해 가상 사설망을 구성하는 것
- VPN 트래픽은 VPN 프로토콜로 보호됨
- 연결 옵션
	- Client VPN : AWS - 클라이언트 연결
	- Site-to-Site VPN (AWS Managed VPN) : AWS 서비스 - 온프레미스 간 연결, 다이렉트 커넥트의 백업용으로도 사용

11. Direct Connect
- AWS와 온프레미스 간에 전용선을 통해 프라이빗 네트워크 연결 생성
- 물리적인 구성을 해야 하기에 설치 시간이 오래 걸림
- VPN 보다 가격이 비싸며 인터넷을 통하지 않기에 인터넷 전송 비용이 들지 않음
- 기본적으로 암호화를 지원하지 않음 (암호화를 위해 Direct Connect에 VPN을 구성 가능)
- Site-to-Site VPN 보다 안정적

12. Transit Gateway
 - 지원되지 않는 여러 VPC의 연결(전이적 피어링)을 가능하게 함
 - 모든 VPC가 Transit Gateway와 연결되어 모든 VPC 간에 연결 가능
 - Transit Gateway 간에도 연결 가능 (TGW 피어링)

### 네트워크 - VPC Endpoint
1. VPC Endpoints
- 퍼블릭 AWS 서비스(VPC 외부의 AWS 서비스)는 기존적으로 인터넷을 통해 연결을 해야함
- 퍼블릭 인터넷을 통한 연결은 데이터가 인터넷에 노출이 되어 보안에 취약할 수 있음
- 데이터를 인터넷에 노출하지 않고 프라이빗 연결을 통해 트래픽 보안을 유지하는 안전한 연결을 위해 사용 VPC Endpoints
- AWS 서비스와 통신하는데 인터넷게이트웨이, NAT 디바이스, 퍼블릭 IP주소를 사용하지 않아도 됨
- VPC 엔드포인트 유형
	- 게이트웨이 엔드포인트 : 라우팅테이블을 사용해서 S3, 다이나모디비에만 연결 가능
		- 동일한 리전에서만 지원
		- 하나의 VPC에 여러 엔드포인트를 만들 수 있으나(S3 용, 다이나모디비 용) 하나의 라우팅 테이블에 동일한 서비스의 여러 엔드포인트 라우팅이 있을 수 없음
		- 제약사항
			- Direct Connent, VPN, VPN 피어링으로 연결된 VPC 외부의 리소스는 게이트웨이 엔드포인트 리소스와 통신할 수 없음 (전이 X)
		- 게이트웨이 엔드포인트 보안
			- IAM 정책
			- EC2 보안그룹
			- VPC 엔드포인트 정책 : 특정 IAM 역할, 사용자만 사용 가능하도록 제한 가능, 특정 버킷이나 특정 테이블에 대한 액세스 제한 가능
			- S3 버킷 정책
	- 인터페이스 엔드포인트 : ENI를 엔트포인트로 사용해서 대부분의 AWS 서비스와 연결 가능
		- AWS PrivateLink를 지원하는 서비스에 대한 프라이빗 연결
		- AWS PrivateLink를 지원하는 서비스는 AWS 서비스, AWS 마켓플레이스 파트너 서비스, 엔드포인트 서비스(AWS 고객이 자체 VPC로 호스팅한 서비스)
		- 인터페이스 엔드포인트를 생성하면 VPC 내에 Private IP를 가지는 ENI가 생성됨
		- TCP, IPv4 트래픽만 지원
		- 동일한 리전에서만 지원
		- 전이를 통한 엔드포인트 연결 가능 (게이트웨이 엔드포인트와 차이)
	- 게이트웨이 로드밸런서 엔드포인트 : 보안 어플라이언스를 사용하는 게이트웨이 로드밸런서와 연결 가능
- AWS PrivateLink : VPC와 AWS 서비스 간에 프라이빗 연결을 제공하는 기술, 인터페이스 엔드포인트, 게이트웨이 로드밸런서 엔드포인트에서 해당 기술을 사용함

2. Endpoint Service
- VPC에 특정 기능을 위한 애플리케이션을 구성
- 애플리케이션 기능을 원하는 고객 VPC와 연결하여 기능 제공
- 많은 고객 VPC 들과 하나하나 VPC 피어링을 맺기에 문제가 있음, CIDR 중복 문제도 있음
- 애플리케이션을 엔드포인트 서비스로 구성하여 해당 문제 해결 가능
- AWS PrivateLink 기술 사용

### 인프라 자동화
1. CloudFormation
- AWS 인프라세트를 수동으로 프로비저닝하면 많은 노력이 소요됨
- CloudFormation을 통해 코드를 작성하여 자동화 가능
- 코드를 사용하여 AWS 인프라 생성, 업데이트, 삭제 가능
- 구성요소
	- 템플릿 : JSON, YAML 형식
	- 스택 : 템플릿을 사용하여 생성된 리소스
	- Change Set : 스택 리소스 변경 사항에 대한 세트

